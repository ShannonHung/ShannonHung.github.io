<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>JDBC Basics and Connection Pooling Explained | Shannon's Blog üêü Tech | Life | Travel</title><meta name="author" content="Shannon Hung"><meta name="copyright" content="Shannon Hung"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="References  What Is JDBC? (14) Dive into JDBC, Connection Pool, and Introduce H2 DB Design Pattern - Object Pool Understanding the Implementation and Principles of Database Connection Pool Why Is Hika">
<meta property="og:type" content="article">
<meta property="og:title" content="JDBC Basics and Connection Pooling Explained">
<meta property="og:url" content="https://shannonhung.github.io/en/posts/about-jdbc-connection-pool/">
<meta property="og:site_name" content="Shannon&#39;s Blog üêü Tech | Life | Travel">
<meta property="og:description" content="References  What Is JDBC? (14) Dive into JDBC, Connection Pool, and Introduce H2 DB Design Pattern - Object Pool Understanding the Implementation and Principles of Database Connection Pool Why Is Hika">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://images.unsplash.com/photo-1483736762161-1d107f3c78e1?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTMyMjU0NQ&ixlib=rb-4.0.3&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=1080">
<meta property="article:published_time" content="2023-07-08T13:45:12.000Z">
<meta property="article:modified_time" content="2023-12-10T00:40:43.424Z">
<meta property="article:author" content="Shannon Hung">
<meta property="article:tag" content="Database">
<meta property="article:tag" content="Connection Pool">
<meta property="article:tag" content="Master&#39;s Thesis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://images.unsplash.com/photo-1483736762161-1d107f3c78e1?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTMyMjU0NQ&ixlib=rb-4.0.3&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=1080"><link rel="shortcut icon" href="/en/img/shannon-icon.png"><link rel="canonical" href="https://shannonhung.github.io/en/posts/about-jdbc-connection-pool/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="IAmwAuWZP3fXPtoYru7VJBancFMT2BkhN15HC2iea1o"/><link rel="stylesheet" href="/en/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-XBNKVVH2P4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XBNKVVH2P4');
</script><script>const GLOBAL_CONFIG = {
  root: '/en/',
  algolia: undefined,
  localSearch: {"path":"/en/search.xml","preload":false,"top_n_per_article":-1,"unescape":false,"languages":{"hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found"}},
  translate: {"defaultEncoding":3,"translateDelay":0,"msgToTraditionalChinese":"ÁπÅ","msgToSimplifiedChinese":"Á∞°"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Error',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'JDBC Basics and Connection Pooling Explained',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-12-10 08:40:43'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/en/css/style.css"><link rel="stylesheet" href="/en/css/background.css"><link rel="shortcut icon" href="#"/></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/en/img/loading-icon.gif" data-original="/en/img/dudu-me.png" onerror="onerror=null;src='/en/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">12</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home Page</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categroies</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About Me</span></a></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> Find Posts</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> By Tags</span></a></li><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> By Posts</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://shannonhung.github.io/"><i class="fa-fw fas fa-c"></i><span> ‰∏≠Êñá</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://images.unsplash.com/photo-1483736762161-1d107f3c78e1?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTMyMjU0NQ&amp;ixlib=rb-4.0.3&amp;q=80&amp;utm_campaign=api-credit&amp;utm_medium=referral&amp;utm_source=unsplash_source&amp;w=1080')"><nav id="nav"><span id="blog-info"><a href="/en/" title="Shannon's Blog üêü Tech | Life | Travel"><span class="site-name">Shannon's Blog üêü Tech | Life | Travel</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/en/"><i class="fa-fw fas fa-home"></i><span> Home Page</span></a></div><div class="menus_item"><a class="site-page" href="/en/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categroies</span></a></div><div class="menus_item"><a class="site-page" href="/en/about/"><i class="fa-fw fas fa-heart"></i><span> About Me</span></a></div><div class="menus_item"><a class="site-page" href="/en/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> Find Posts</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/tags/"><i class="fa-fw fas fa-tags"></i><span> By Tags</span></a></li><li><a class="site-page child" href="/en/archives/"><i class="fa-fw fas fa-archive"></i><span> By Posts</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-language"></i><span> Language</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="https://shannonhung.github.io/"><i class="fa-fw fas fa-c"></i><span> ‰∏≠Êñá</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">JDBC Basics and Connection Pooling Explained</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-07-08T13:45:12.000Z" title="Created 2023-07-08 21:45:12">2023-07-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2023-12-10T00:40:43.424Z" title="Updated 2023-12-10 08:40:43">2023-12-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Research/">Research</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Research/Database/">Database</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/en/categories/Research/Thesis/">Thesis</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">2.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>17mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="JDBC Basics and Connection Pooling Explained"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/en/posts/about-jdbc-connection-pool/#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="References">References</h1>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.1ju.org/jdbc/jdbc-introduction">What Is JDBC?</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.com/learning-from-jhipster/14-%E6%B7%B1%E5%85%A5-jdbc-connection-pool-%E4%B8%A6%E5%B0%8E%E5%85%A5-h2-db-939adee9c50">(14) Dive into JDBC, Connection Pool, and Introduce H2 DB</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.com/@sawomirkowalski/design-patterns-object-pool-e8269fd45e10">Design Pattern - Object Pool</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://iter01.com/16624.html">Understanding the Implementation and Principles of Database Connection Pool</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.linqz.io/2019/03/why-to-use-hikari-connection-pool.html">Why Is Hikari So Fast</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/assember/article/details/121976290">Difference Between spring-boot-starter-jdbc and spring-boot-starter-data-jdbc</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring-boot/docs/current/reference/html/appendix-application-properties.html#data-properties">Spring Boot - Data Properties</a></li>
</ul>
<h1 id="Introduction">Introduction</h1>
<p>JDBC, short for Java Database Connectivity, is primarily an API standard used for <strong>connecting Java programming language to databases</strong>. You can also think of it as a library. But what exactly does this API standard encompass?</p>
<ol>
<li>Connecting to a database.</li>
<li>Creating and executing SQL statements.</li>
</ol>
<h1 id="JDBC-Architecture">JDBC Architecture</h1>
<p><img src="/en/img/loading-icon.gif" data-original="https://i.imgur.com/D1mM5vk.png" alt=""><br>
The JDBC API provides the following interfaces and classes:</p>
<ul>
<li><code>Driver Manager</code>: Manages a list of database drivers. It matches connection requests from Java applications with the appropriate database driver to <strong>establish a database connection</strong>.</li>
<li><code>Driver</code>: <strong>Handles communication with the database</strong>. It is rarely communicated with directly, and instead, interactions are managed through the Driver Manager.</li>
<li><code>Connection</code>: Provides <strong>methods for connecting to the database</strong>.</li>
<li><code>Statement</code>: Used for <strong>executing SQL statements</strong> and returning results.</li>
<li><code>ResultSet</code>: Used for <strong>holding the results obtained from a database query</strong>.</li>
<li><code>SQLException</code>: This class handles <strong>any errors that occur in the database application</strong>.</li>
</ul>
<blockquote>
<p>You can understand the purposes of JDBC API interfaces through the following example:</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Reference: https://medium.com/learning-from-jhipster/14-%E6%B7%B1%E5%85%A5-jdbc-connection-pool-%E4%B8%A6%E5%B0%8E%E5%85%A5-h2-db-939adee9c50</span></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SQLDatabaseConnection</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Connect to your database.</span></span><br><span class="line">  <span class="comment">// Replace server name, username, and password with your credentials</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">    <span class="comment">// 1. Load the JDBC Driver for SQL Server</span></span><br><span class="line">    Class.forName(<span class="string">&quot;com.microsoft.sqlserver.jdbc.SQLServerDriver&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2. Edit the connection URL</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">connectionUrl</span> <span class="operator">=</span></span><br><span class="line">        <span class="string">&quot;jdbc:sqlserver://yourserver.database.windows.net:1433;&quot;</span></span><br><span class="line">        + <span class="string">&quot;database=AdventureWorks;&quot;</span></span><br><span class="line">        + <span class="string">&quot;user=yourusername@yourserver;&quot;</span></span><br><span class="line">        + <span class="string">&quot;password=yourpassword;&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Used to hold the result set</span></span><br><span class="line">    <span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html</span></span><br><span class="line">    <span class="keyword">try</span> (</span><br><span class="line">      <span class="comment">// 3. Establish a connection</span></span><br><span class="line">      <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(connectionUrl);</span><br><span class="line">      <span class="comment">// 4. Create a Statement object for executing SQL commands</span></span><br><span class="line">      <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> connection.createStatement();</span><br><span class="line">    ) &#123;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Create and execute a SELECT SQL statement.</span></span><br><span class="line">      <span class="type">String</span> <span class="variable">selectSql</span> <span class="operator">=</span> <span class="string">&quot;SELECT TOP 10 Title, FirstName, LastName from SalesLT.Customer&quot;</span>;</span><br><span class="line">      <span class="comment">// 5. Execute the SQL command and retrieve the result</span></span><br><span class="line">      resultSet = statement.executeQuery(selectSql);</span><br><span class="line"></span><br><span class="line">      <span class="comment">// Print results from the select statement</span></span><br><span class="line">      <span class="keyword">while</span> (resultSet.next()) &#123;</span><br><span class="line">        System.out.println(resultSet.getString(<span class="number">2</span>) + <span class="string">&quot; &quot;</span> + resultSet.getString(<span class="number">3</span>));</span><br><span class="line">      &#125;</span><br><span class="line">      </span><br><span class="line">      <span class="comment">// Cleanup</span></span><br><span class="line">      <span class="comment">// 6. Release resources, close the Connection, and Statement</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">      e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="JDBC-Connection">JDBC Connection</h1>
<p>Usually, to establish a database connection, the following steps are required:</p>
<ol>
<li><strong>Set up the Driver</strong>: Load the JDBC Driver for SQL Server.</li>
<li><strong>Create a Connection</strong>: (Using <code>DriverManager.getConnection()</code>) to establish a TCP socket connection.</li>
<li><strong>Submit SQL</strong>: Create a <code>Statement</code> and execute SQL commands.</li>
<li><strong>Close the Connection</strong>: Close the TCP socket.</li>
</ol>
<p>However, every time we need to communicate with the database, performing these steps repeatedly can create unnecessary overhead for the system.</p>
<div class="note info flat"><p>If we can extract those repetitive actions every time we connect, we can reduce the system‚Äôs burden and improve program execution performance. <strong>This is what we are going to discuss next - Connection Pooling</strong>.</p>
</div>
<h2 id="Connection-Pool">Connection Pool</h2>
<p>Connection Pooling is implemented using the ‚ÄúObject Pool Pattern.‚Äù Let‚Äôs start with a brief explanation from Wikipedia:</p>
<blockquote><p>The object pool pattern is a creational design pattern. <strong>An object pool contains a set of initialized and ready-to-use objects</strong> that can be created and destroyed as needed. Clients can request objects from the pool, use them for processing, and return them to the pool instead of creating and destroying them directly. It‚Äôs a special kind of factory object.</p>
<footer><strong>wiki</strong><cite><a target="_blank" rel="noopener external nofollow noreferrer" href="https://en.wikipedia.org/wiki/Object_pool_pattern">en.wikipedia.org/wiki/Object_pool_pattern</a></cite></footer></blockquote>
<p>In simple terms, it means pre-creating and storing some commonly used objects in a pool. When needed, you can directly take objects from the pool, avoiding the need to recreate them every time. <strong>Using an object pool can significantly improve performance. The time to get an object from the pool is predictable, whereas creating a new instance takes an uncertain amount of time.</strong></p>
<p>The following diagram illustrates how clients use connections from the pool to connect to a data source. The main tasks are:</p>
<ol>
<li>Managing available connections.</li>
<li>Allocating connections.</li>
<li>Releasing connections.</li>
</ol>
<p><img src="/en/img/loading-icon.gif" data-original="https://i.imgur.com/5NFJcwZ.png" alt=""></p>
<p>Now, let‚Äôs take a look at the UML diagram:</p>
<ul>
<li><code>Object Pool Class</code>: It is a Singleton, meaning it has a private constructor and a static <code>getInstance()</code> method to obtain an instance of the Object Pool.</li>
<li><code>acquireReusable()</code>: Used to get objects from the Object Pool. If there are no available objects, it will create a new one.</li>
<li><code>releaseReusable()</code>: Used to release an object from the client‚Äôs hand and return it to the available objects.</li>
<li><code>setMaxPoolSize()</code>: Used to set the maximum capacity of the Object Pool.</li>
</ul>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden>
  classDiagram
    class client
    class ResuablePool{
        - reusable
        +BigDecimal balance
        +static getInstance() ReusablePool
        +acquireReusable() Reusable
        +releaseReusable(Reusable reusable)
        +setMaxPoolSize(int maxPoolSize)
    }
    client --&gt; ResuablePool : ResusablePool.getInstance().acquareReusable()
  </pre></div>
<h2 id="JDBC-Connection-Pool-Example">JDBC Connection Pool Example</h2>
<p>You can refer to <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/MicrosoftDocs/azure-docs.zh-tw/blob/master/articles/mysql/sample-scripts-java-connection-pooling.md">Azure‚Äôs approach</a> for a simple JDBC Connection Pool implementation. Inside, you can see how a Connection Pool is implemented.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MySQLConnectionPool</span> &#123;</span><br><span class="line">    <span class="comment">// Connection information</span></span><br><span class="line">    <span class="keyword">private</span> String databaseUrl;</span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="comment">// Pool size</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">maxPoolSize</span> <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">    <span class="comment">// Current number of connections</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> <span class="variable">connNum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">SQL_VERIFYCONN</span> <span class="operator">=</span> <span class="string">&quot;select 1&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Currently available connections</span></span><br><span class="line">    Stack&lt;Connection&gt; freePool = <span class="keyword">new</span> <span class="title class_">Stack</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// Currently in-use connections</span></span><br><span class="line">    Set&lt;Connection&gt; occupiedPool = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Constructor: Create a Connection Pool</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> databaseUrl</span></span><br><span class="line"><span class="comment">     *            The connection URL</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> userName</span></span><br><span class="line"><span class="comment">     *            User name</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> password</span></span><br><span class="line"><span class="comment">     *            Password</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> maxSize</span></span><br><span class="line"><span class="comment">     *            Max size of the connection pool</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MySQLConnectionPool</span><span class="params">(String databaseUrl, String userName,</span></span><br><span class="line"><span class="params">            String password, <span class="type">int</span> maxSize)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.databaseUrl = databaseUrl;</span><br><span class="line">        <span class="built_in">this</span>.userName = userName;</span><br><span class="line">        <span class="built_in">this</span>.password = password;</span><br><span class="line">        <span class="built_in">this</span>.maxPoolSize = maxSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get an available connection</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> An available connection</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     *             Fail to get an available connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> Connection <span class="title function_">getConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Cannot create a new connection (reached the maximum limit)</span></span><br><span class="line">        <span class="keyword">if</span> (isFull()) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">SQLException</span>(<span class="string">&quot;The connection pool is full.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Return a connection from the freePool and mark it as occupied</span></span><br><span class="line">        conn = getConnectionFromPool();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// If conn is null, it means there are no objects in freePool, so we need to create a new connection</span></span><br><span class="line">        <span class="keyword">if</span> (conn == <span class="literal">null</span>) &#123;</span><br><span class="line">            conn = createNewConnectionForPool();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Some databases automatically disconnect idle connections after some time, so we check if the connection is still active</span></span><br><span class="line">        <span class="comment">// For Azure Database for MySQL, if there is no action on one connection for some time, the connection is lost. By this, make sure the connection is</span></span><br><span class="line">        <span class="comment">// active. Otherwise, reconnect it.</span></span><br><span class="line">        conn = makeAvailable(conn);</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Return a connection to the pool</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">     *            The connection</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     *             When the connection is returned already or it isn&#x27;t gotten</span></span><br><span class="line"><span class="comment">     *             from the pool.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">void</span> <span class="title function_">returnConnection</span><span class="params">(Connection conn)</span></span><br><span class="line">            <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// If conn is null, it means the client hasn&#x27;t used the connection, so there&#x27;s no need to return it</span></span><br><span class="line">        <span class="keyword">if</span> (conn == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">NullPointerException</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Check if conn is in the occupiedPool and can be removed from it, if not, throw SQLException</span></span><br><span class="line">        <span class="keyword">if</span> (!occupiedPool.remove(conn)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">SQLException</span>(</span><br><span class="line">                    <span class="string">&quot;The connection is returned already or it isn&#x27;t for this pool&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// If no exception is thrown, it&#x27;s removed from occupiedPool and can be returned to freePool</span></span><br><span class="line">        freePool.push(conn);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Verify if the connection pool is full</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> True if the connection pool is full</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">synchronized</span> <span class="type">boolean</span> <span class="title function_">isFull</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ((freePool.size() == <span class="number">0</span>) &amp;&amp; (connNum &gt;= maxPoolSize));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a connection for the pool</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The new created connection</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     *             When fail to create a new connection.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Connection <span class="title function_">createNewConnectionForPool</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> createNewConnection();</span><br><span class="line">        connNum++;</span><br><span class="line">        occupiedPool.add(conn);</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Create a new connection</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The new created connection</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     *             When fail to create a new connection.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Connection <span class="title function_">createNewConnection</span><span class="params">()</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        conn = DriverManager.getConnection(databaseUrl, userName, password);</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get a connection from the pool. If there is no free connection, return null</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The connection.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Connection <span class="title function_">getConnectionFromPool</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">if</span> (freePool.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            conn = freePool.pop();</span><br><span class="line">            occupiedPool.add(conn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Make sure the connection is available now. Otherwise, reconnect it.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">     *            The connection for verification.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> The available connection.</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> SQLException</span></span><br><span class="line"><span class="comment">     *             Fail to get an available connection</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Connection <span class="title function_">makeAvailable</span><span class="params">(Connection conn)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="comment">// Verify if the connection is still active by running a query</span></span><br><span class="line">        <span class="keyword">if</span> (isConnectionAvailable(conn)) &#123;</span><br><span class="line">            <span class="keyword">return</span> conn;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// If the connection is found to be inactive, remove it from occupiedPool and close it</span></span><br><span class="line">        occupiedPool.remove(conn);</span><br><span class="line">        connNum--;</span><br><span class="line">        conn.close();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Then create a new connection and add it to occupiedPool</span></span><br><span class="line">        conn = createNewConnection();</span><br><span class="line">        occupiedPool.add(conn);</span><br><span class="line">        connNum++;</span><br><span class="line">        <span class="keyword">return</span> conn;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Check if the connection is available by running a query</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> conn</span></span><br><span class="line"><span class="comment">     *            The connection for verification</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> True if the connection is available</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">isConnectionAvailable</span><span class="params">(Connection conn)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> (<span class="type">Statement</span> <span class="variable">st</span> <span class="operator">=</span> conn.createStatement()) &#123;</span><br><span class="line">            st.executeQuery(SQL_VERIFYCONN);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Just an Example</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> SQLException &#123;</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">conn</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="comment">// Create a connection pool</span></span><br><span class="line">        <span class="type">MySQLConnectionPool</span> <span class="variable">pool</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MySQLConnectionPool</span>(</span><br><span class="line">                <span class="string">&quot;jdbc:mysql://mysqlaasdevintic-sha.cloudapp.net:3306/&lt;Your DB name&gt;&quot;</span>,</span><br><span class="line">                <span class="string">&quot;&lt;Your user&gt;&quot;</span>, <span class="string">&quot;&lt;Your Password&gt;&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Get a connection</span></span><br><span class="line">            conn = pool.getConnection();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Prepare a query to execute</span></span><br><span class="line">            <span class="keyword">try</span> (<span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> conn.createStatement())</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">ResultSet</span> <span class="variable">res</span> <span class="operator">=</span> statement.executeQuery(<span class="string">&quot;show tables&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;There are below tables:&quot;</span>);</span><br><span class="line">                <span class="keyword">while</span> (res.next()) &#123;</span><br><span class="line">                    <span class="type">String</span> <span class="variable">tblName</span> <span class="operator">=</span> res.getString(<span class="number">1</span>);</span><br><span class="line">                    System.out.println(tblName);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (conn != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="comment">// Release the connection</span></span><br><span class="line">                pool.returnConnection(conn);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="About-Third-Party-Connection-Pool-Libraries">About Third-Party Connection Pool Libraries</h1>
<p>Now that we understand how Connection Pools work, it‚Äôs important to note that there are many mature third-party libraries available for us to use. These third-party Connection Pool libraries have been optimized for performance and reducing redundant work.</p>
<blockquote><p>The development of different third-party Connection Pools is primarily driven by performance considerations. Since JDBC has defined interfaces for JDBC Drivers, these third-party Connection Pool libraries adhere to the JDBC Driver Interface API. They all have the same API, but the difference lies in the internal implementation, which affects performance.</p>
<footer><strong>Albert</strong><cite><a target="_blank" rel="noopener external nofollow noreferrer" href="https://medium.com/learning-from-jhipster/14-%E6%B7%B1%E5%85%A5-jdbc-connection-pool-%E4%B8%A6%E5%B0%8E%E5%85%A5-h2-db-939adee9c50">medium.com/learning-from-jhipster/14-%E6%B7%B1%E5%85%A5-jdbc-connection-pool-%E4%B8%A6%E5%B0%8E%E5%85%A5-h2-db-939adee9c50</a></cite></footer></blockquote>
<p>Currently, the most powerful and high-performance third-party Connection Pool library is HikariCP, with performance that surpasses other Connection Pool libraries by more than two times.<br>
In the graph below:</p>
<ul>
<li><strong>Connection Cycle Comparison</strong>: It shows the connection speed from <code>DataSource.getConnection()</code> to <code>Connection.close()</code>. HikariCP can complete around 40,000 to 50,000 connections in less than 1 millisecond.</li>
<li><strong>Statement Cycle Comparison</strong>: It shows the SQL execution speed from <code>Connection.prepareStatement()</code> to <code>Statement.execute()</code> to <code>Statement.close()</code>. In terms of SQL execution speed, it can complete approximately 15,000 cycles within 1 millisecond. The only other library that can keep up is Tomcat‚Äôs JDBC Connection Pool; other libraries have much lower performance.</li>
</ul>
<blockquote>
<p>To understand why it is so fast, you can read this article: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.linqz.io/2019/03/why-to-use-hikari-connection-pool.html">Reasons for HikariCP‚Äôs Speed</a></p>
</blockquote>
<p><img src="/en/img/loading-icon.gif" data-original="https://i.imgur.com/0d8CJ8e.png" alt=""></p>
<h1 id="About-Third-Party-Libraries-Used-by-Spring-Boot">About Third-Party Libraries Used by Spring Boot</h1>
<p>Previously, we explained how to connect to databases using JDBC and the importance of Connection Pools. In Spring Boot, a series of commonly used tools are integrated, simplifying configuration tasks related to JDBC, Connection Pools, JPA, and more.</p>
<p>Now, you only need to import dependencies and configure properties to quickly and conveniently establish a connection with the database. If you want to communicate with a database using a Java application, you typically import the <code>spring-boot-starter-jdbc</code> library:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>But now it mainly uses <code>spring-boot-starter-data-jdbc</code>, with an extra word for data!</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Spring-Boot-Starters-for-Data-and-JDBC">Spring Boot Starters for Data and JDBC</h2>
<p>When using <code>spring-boot-starter-jdbc</code> or <code>spring-boot-starter-data-jpa</code> starters, we automatically get a dependency on HikariCP. (See the snapshot below)<br>
<img src="/en/img/loading-icon.gif" data-original="https://i.imgur.com/BO5bFfS.png" alt=""></p>
<p>But what‚Äôs the difference between these data-related starters? If you are developing with JPA, the most commonly used one is <code>spring-boot-starter-data-jdbc</code>.</p>
<ul>
<li><code>spring-boot-starter-jdbc</code>: This starter is the most basic package. If you only need JDBC, you can import this starter.</li>
<li><code>spring-boot-starter-data-jdbc</code>: This starter builds upon <code>spring-boot-starter-jdbc</code> and provides a quick development interface for <code>curdRepository</code>. If you need to use JPA, then you should import this starter.</li>
</ul>
<blockquote>
<p>spring-jdbc (from: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://blog.csdn.net/assember/article/details/121976290">https://blog.csdn.net/assember/article/details/121976290</a>)</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RunAQuery</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// only provide basic JDBC connection</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setDataSource</span><span class="params">(DataSource dataSource)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.jdbcTemplate = <span class="keyword">new</span> <span class="title class_">JdbcTemplate</span>(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getCount</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.jdbcTemplate.queryForObject(<span class="string">&quot;select count(*) from mytable&quot;</span>, Integer.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.jdbcTemplate.queryForObject(<span class="string">&quot;select name from mytable&quot;</span>, String.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>spring-data-jdbc Except for the basic database connection, it also provides CrudReporitoy</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.data.repository.CrudRepository;</span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserRepository</span> <span class="keyword">extends</span> <span class="title class_">CrudRepository</span>&lt;User, Long&gt; &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/en/img/loading-icon.gif" data-original="https://i.imgur.com/08ZhuEH.png" alt=""></p>
<h2 id="Properties-Configuration">Properties Configuration</h2>
<p>If you take a closer look at this starter‚Äôs content, you will find that it mainly includes two dependencies:</p>
<ol>
<li>spring-JDBC: This is Spring‚Äôs library that wraps JDBC. If you use this starter, you must configure the database connection information in the properties (application.yml).</li>
<li>HikariCP: Spring Boot uses HikariCP as the default Connection Pool and includes it in <code>spring-boot-starter-jdbc</code>. (It‚Äôs highly efficient!)</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zaxxer<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>HikariCP<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Can refer to Spring Boot - Data Properties for configuration methods:</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="comment"># To use HikariCP, you can configure it directly using spring.datasource.*</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">Configure</span> <span class="string">the</span> <span class="string">type</span> <span class="string">of</span> <span class="string">DataSource</span> <span class="string">for</span> <span class="string">the</span> <span class="string">Connection</span> <span class="string">Pool</span> <span class="string">(or</span> <span class="string">automatically</span> <span class="string">detect</span> <span class="string">from</span> <span class="string">classpath)</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">Configure</span> <span class="string">the</span> <span class="string">JDBC</span> <span class="string">URL</span> <span class="string">for</span> <span class="string">connecting</span> <span class="string">to</span> <span class="string">the</span> <span class="string">database</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">Configure</span> <span class="string">the</span> <span class="string">username</span> <span class="string">for</span> <span class="string">connecting</span> <span class="string">to</span> <span class="string">the</span> <span class="string">database</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">Configure</span> <span class="string">the</span> <span class="string">password</span> <span class="string">for</span> <span class="string">connecting</span> <span class="string">to</span> <span class="string">the</span> <span class="string">database</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">Configure</span> <span class="string">the</span> <span class="string">JDBC</span> <span class="string">driver</span> <span class="string">class</span> <span class="string">(or</span> <span class="string">automatically</span> <span class="string">detect</span> <span class="string">based</span> <span class="string">on</span> <span class="string">the</span> <span class="string">URL)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="spring-datasource-type">spring.datasource.type</h2>
<p>Since we‚Äôve imported <code>spring-boot-starter-data-jdbc</code>, we can directly use <code>spring.datasource.type</code> to configure the Connection Pool we want to use. By default, Spring Boot will automatically detect it from the classpath, and if it‚Äôs not found, it will default to HikariCP.</p>
<p>If you‚Äôre curious about how it auto-detects or which class names it can auto-detect, you can refer to the <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/spring-projects/spring-boot/blob/master/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jdbc/DataSourceBuilder.java">DataSourceBuilder.java ‚Äî Source Code</a>, or check out the code snippet below:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> &lt;T <span class="keyword">extends</span> <span class="title class_">DataSource</span>&gt; MappedDataSourceProperties&lt;T&gt; <span class="title function_">lookupPooled</span><span class="params">(ClassLoader classLoader,</span></span><br><span class="line"><span class="params">		Class&lt;T&gt; type)</span> &#123;</span><br><span class="line">	MappedDataSourceProperties&lt;T&gt; result = <span class="literal">null</span>;</span><br><span class="line">	result = lookup(classLoader, type, result, <span class="string">&quot;com.zaxxer.hikari.HikariDataSource&quot;</span>,</span><br><span class="line">			HikariDataSourceProperties::<span class="keyword">new</span>);</span><br><span class="line">	result = lookup(classLoader, type, result, <span class="string">&quot;org.apache.tomcat.jdbc.pool.DataSource&quot;</span>,</span><br><span class="line">			TomcatPoolDataSourceProperties::<span class="keyword">new</span>);</span><br><span class="line">	result = lookup(classLoader, type, result, <span class="string">&quot;org.apache.commons.dbcp2.BasicDataSource&quot;</span>,</span><br><span class="line">			MappedDbcp2DataSource::<span class="keyword">new</span>);</span><br><span class="line">	result = lookup(classLoader, type, result, <span class="string">&quot;oracle.ucp.jdbc.PoolDataSourceImpl&quot;</span>,</span><br><span class="line">			OraclePoolDataSourceProperties::<span class="keyword">new</span>, <span class="string">&quot;oracle.jdbc.OracleConnection&quot;</span>);</span><br><span class="line">	result = lookup(classLoader, type, result, <span class="string">&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;</span>,</span><br><span class="line">			ComboPooledDataSourceProperties::<span class="keyword">new</span>);</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>In this code snippet, we can see that Spring Boot automatically detects several Connection Pool implementations, with HikariCP being the default choice.</p>
<ul>
<li><code>org.springframework.jdbc.datasource.SimpleDriverDataSource</code></li>
<li><code>com.zaxxer.hikari.HikariDataSource</code></li>
<li><code>org.apache.tomcat.jdbc.pool.DataSource</code></li>
<li><code>oracle.ucp.jdbc.PoolDataSourceImpl</code></li>
<li><code>oracle.jdbc.OracleConnection</code></li>
<li>and more.</li>
</ul>
<blockquote><p>If you use the spring-boot-starter-jdbc or spring-boot-starter-data-jpa ‚Äústarters‚Äù, you automatically get a dependency to HikariCP.</p>
<footer><strong>spring-doc</strong><cite><a target="_blank" rel="noopener external nofollow noreferrer" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#data.sql.datasource.connection-pool">docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#data.sql.datasource.connection-pool</a></cite></footer></blockquote>
<div class="note danger flat"><p>Regarding <code>org.springframework.jdbc.datasource.SimpleDriverDataSource</code>, check its <a target="_blank" rel="noopener external nofollow noreferrer" href="https://mvnrepository.com/artifact/org.springframework/spring-jdbc">API documentation</a>, and you‚Äôll find the note <strong>This class is not an actual connection pool; it does not actually pool Connections</strong>. This means that this class is not a genuine Connection Pool, and it doesn‚Äôt perform Connection Pooling operations.</p>
</div>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://shannonhung.github.io/en">Shannon Hung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://shannonhung.github.io/en/posts/about-jdbc-connection-pool/">https://shannonhung.github.io/en/posts/about-jdbc-connection-pool/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/en/tags/Database/">Database</a><a class="post-meta__tags" href="/en/tags/Connection-Pool/">Connection Pool</a><a class="post-meta__tags" href="/en/tags/Master-s-Thesis/">Master's Thesis</a></div><div class="post_share"><div class="social-share" data-image="https://images.unsplash.com/photo-1483736762161-1d107f3c78e1?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTMyMjU0NQ&amp;ixlib=rb-4.0.3&amp;q=80&amp;utm_campaign=api-credit&amp;utm_medium=referral&amp;utm_source=unsplash_source&amp;w=1080" data-sites="facebook"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/en/posts/interupt-connection-pool/" title="How to Intervene in Connection Pool?"><img class="cover" src="/en/img/loading-icon.gif" data-original="https://images.unsplash.com/photo-1529078155058-5d716f45d604?crop=entropy&amp;cs=tinysrgb&amp;fit=max&amp;fm=jpg&amp;ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTMzMzk2Mg&amp;ixlib=rb-4.0.3&amp;q=80&amp;utm_campaign=api-credit&amp;utm_medium=referral&amp;utm_source=unsplash_source&amp;w=1080" onerror="onerror=null;src='/en/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next</div><div class="next_info">How to Intervene in Connection Pool?</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/en/posts/interupt-connection-pool/" title="How to Intervene in Connection Pool?"><img class="cover" src="/en/img/loading-icon.gif" data-original="https://images.unsplash.com/photo-1529078155058-5d716f45d604?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTMzMzk2Mg&ixlib=rb-4.0.3&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=1080" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-10</div><div class="title">How to Intervene in Connection Pool?</div></div></a></div><div><a href="/en/posts/security-for-storage-infra/" title="NIST SP 800-209 Security Guidelines for Storage (1) Threats and Risks"><img class="cover" src="/en/img/loading-icon.gif" data-original="https://images.unsplash.com/photo-1506399558188-acca6f8cbf41?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTc3MTc2MA&ixlib=rb-4.0.3&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=1080" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-13</div><div class="title">NIST SP 800-209 Security Guidelines for Storage (1) Threats and Risks</div></div></a></div><div><a href="/en/posts/security-for-storage-infra-2/" title="NIST SP 800-209 Security Guidelines for Storage (2)"><img class="cover" src="/en/img/loading-icon.gif" data-original="https://images.unsplash.com/photo-1506399558188-acca6f8cbf41?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxfDB8MXxyYW5kb218MHx8fHx8fHx8MTY4MTc3MTc2MA&ixlib=rb-4.0.3&q=80&utm_campaign=api-credit&utm_medium=referral&utm_source=unsplash_source&w=1080" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-07-27</div><div class="title">NIST SP 800-209 Security Guidelines for Storage (2)</div></div></a></div><div><a href="/en/posts/zta-survey/" title="Zero Trust Architecture (ZTA) Principles Applied to AP and DB"><img class="cover" src="/en/img/loading-icon.gif" data-original="/en/img/cover/zero-trust.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-08-03</div><div class="title">Zero Trust Architecture (ZTA) Principles Applied to AP and DB</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/en/img/loading-icon.gif" data-original="/en/img/dudu-me.png" onerror="this.onerror=null;this.src='/en/en/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Shannon Hung</div><div class="author-info__description">In order to avoid forgetfulness, I started to record</div></div><div class="card-info-data site-data is-center"><a href="/en/archives/"><div class="headline">Articles</div><div class="length-num">13</div></a><a href="/en/tags/"><div class="headline">Tags</div><div class="length-num">12</div></a><a href="/en/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ShannonHung"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ShannonHung" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:hsuanhung036@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #24292e;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">I am a graduate student at the Taiwan University of Science and Technology - Institute of Information Management, planning to pursue a dual-degree program in Germany this year. The reason behind setting up this website is my rather short memory span. While I have learned a lot, I tend to forget much of it. To combat forgetfulness, I have embarked on my note-taking journey.</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#References"><span class="toc-text">References</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Introduction"><span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JDBC-Architecture"><span class="toc-text">JDBC Architecture</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#JDBC-Connection"><span class="toc-text">JDBC Connection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Connection-Pool"><span class="toc-text">Connection Pool</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JDBC-Connection-Pool-Example"><span class="toc-text">JDBC Connection Pool Example</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#About-Third-Party-Connection-Pool-Libraries"><span class="toc-text">About Third-Party Connection Pool Libraries</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#About-Third-Party-Libraries-Used-by-Spring-Boot"><span class="toc-text">About Third-Party Libraries Used by Spring Boot</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-Boot-Starters-for-Data-and-JDBC"><span class="toc-text">Spring Boot Starters for Data and JDBC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Properties-Configuration"><span class="toc-text">Properties Configuration</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#spring-datasource-type"><span class="toc-text">spring.datasource.type</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/en/posts/TensorFlow-Windows-GPU-Setup/" title="Windows - A Step-by-Step Guide to Enable CUDA GPU on TensorFlow"><img src="/en/img/loading-icon.gif" data-original="/en/img/cover/mac_ai_gpu.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Windows - A Step-by-Step Guide to Enable CUDA GPU on TensorFlow"/></a><div class="content"><a class="title" href="/en/posts/TensorFlow-Windows-GPU-Setup/" title="Windows - A Step-by-Step Guide to Enable CUDA GPU on TensorFlow">Windows - A Step-by-Step Guide to Enable CUDA GPU on TensorFlow</a><time datetime="2024-04-09T12:55:39.000Z" title="Created 2024-04-09 20:55:39">2024-04-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/textract-multi-column/" title="How to Handle Multi-Column Text Sorting with Amazon Textract"><img src="/en/img/loading-icon.gif" data-original="/en/img/cover/ocr-scan.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="How to Handle Multi-Column Text Sorting with Amazon Textract"/></a><div class="content"><a class="title" href="/en/posts/textract-multi-column/" title="How to Handle Multi-Column Text Sorting with Amazon Textract">How to Handle Multi-Column Text Sorting with Amazon Textract</a><time datetime="2024-03-19T16:40:35.000Z" title="Created 2024-03-20 00:40:35">2024-03-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/nlp-twitter-emotion-diagnoise/" title="Twitter Dataset - Using LSTM to predict the emotion of the article"><img src="/en/img/loading-icon.gif" data-original="/en/img/cover/lstm-emotion.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Twitter Dataset - Using LSTM to predict the emotion of the article"/></a><div class="content"><a class="title" href="/en/posts/nlp-twitter-emotion-diagnoise/" title="Twitter Dataset - Using LSTM to predict the emotion of the article">Twitter Dataset - Using LSTM to predict the emotion of the article</a><time datetime="2023-11-16T06:30:45.000Z" title="Created 2023-11-16 14:30:45">2023-11-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/coco-object-diagnoise/" title="COCO Dataset - use Faster RCNN + MobileNet to conduct Object Detection"><img src="/en/img/loading-icon.gif" data-original="/en/img/cover/object-detection.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="COCO Dataset - use Faster RCNN + MobileNet to conduct Object Detection"/></a><div class="content"><a class="title" href="/en/posts/coco-object-diagnoise/" title="COCO Dataset - use Faster RCNN + MobileNet to conduct Object Detection">COCO Dataset - use Faster RCNN + MobileNet to conduct Object Detection</a><time datetime="2023-11-03T02:57:54.000Z" title="Created 2023-11-03 10:57:54">2023-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/en/posts/flower102-transfer-learning/" title="Flower102 Dataset - Using Transfer Learning to train + Using Batch Normalization in CNN"><img src="/en/img/loading-icon.gif" data-original="/en/img/cover/flower-ml.jpeg" onerror="this.onerror=null;this.src='/en/img/404.jpg'" alt="Flower102 Dataset - Using Transfer Learning to train + Using Batch Normalization in CNN"/></a><div class="content"><a class="title" href="/en/posts/flower102-transfer-learning/" title="Flower102 Dataset - Using Transfer Learning to train + Using Batch Normalization in CNN">Flower102 Dataset - Using Transfer Learning to train + Using Batch Normalization in CNN</a><time datetime="2023-10-31T06:27:13.000Z" title="Created 2023-10-31 14:27:13">2023-10-31</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By Shannon Hung</div><div class="footer_custom_text">Hi, welcome to Shannon <a target="_blank" rel="noopener external nofollow noreferrer" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="Toggle between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional Chinese And Simplified Chinese">EN</button><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/en/js/utils.js"></script><script src="/en/js/main.js"></script><script src="/en/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: '51917ecdc184bb98b226',
      clientSecret: 'e48b44c1908c14b74ff7513f06c7cb892a4f4748',
      repo: 'shannonhung.github.io',
      owner: 'ShannonHung',
      admin: ['ShannonHung'],
      id: '241396ef61d3867e5d24a7f17d68838a',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script data-pjax src="/en/self/btf.js"></script><script data-pjax src="/en/self/tw_en.js"></script><script id="canvas_nest" defer="defer" color="139,71,38" opacity="0.5" zIndex="-1" count="500" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/en/js/search/local-search.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 3,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>