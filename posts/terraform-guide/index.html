<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Terraform æ–°æ‰‹ä»‹ç´¹ - ä¸€ç¯‡ç«‹åˆ»ææ‡‚ Terrafrom çš„æ ¸å¿ƒèˆ‡åŸºç¤å…ƒä»¶ | Shannon's Blog ğŸŸ æŠ€è¡“ | ç”Ÿæ´» | æ—…è¡Œ</title><meta name="author" content="Shannon Hung"><meta name="copyright" content="Shannon Hung"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="ä»‹ç´¹ Terraform æ˜¯ç”± HashiCorp é–‹ç™¼çš„ä¸€ç¨®IaCç®¡ç†å·¥å…·ï¼Œå…¶èª•ç”Ÿçš„åŸå› ä¾†è‡ªç¾ä»£ IT åŸºç¤è¨­æ–½ç®¡ç†ä¸­å°è‡ªå‹•åŒ–ã€å¯é‡è¤‡æ€§å’Œè·¨å¹³å°æ”¯æŒçš„éœ€æ±‚ã€‚éš¨è‘—é›²è¨ˆç®—çš„æ™®åŠï¼Œä¼æ¥­çš„åŸºç¤è¨­æ–½è®Šå¾—è¶Šä¾†è¶Šå‹•æ…‹ï¼Œç®¡ç†å¤šé›²ç’°å¢ƒï¼ˆå¦‚ AWSã€Azureã€Google Cloudï¼‰å’Œæœ¬åœ°æ•¸æ“šä¸­å¿ƒçš„è³‡æºè®Šå¾—è¤‡é›œä¸”å®¹æ˜“å‡ºéŒ¯ã€‚å‚³çµ±çš„æ‰‹å‹•é…ç½®æ–¹å¼ä¸åƒ…æ•ˆç‡ä½ï¼Œé‚„å®¹æ˜“å°è‡´ç’°å¢ƒä¹‹é–“çš„ä¸ä¸€è‡´ã€‚ Terraform çš„ç”¢ç”Ÿä¸»è¦">
<meta property="og:type" content="article">
<meta property="og:title" content="Terraform æ–°æ‰‹ä»‹ç´¹ - ä¸€ç¯‡ç«‹åˆ»ææ‡‚ Terrafrom çš„æ ¸å¿ƒèˆ‡åŸºç¤å…ƒä»¶">
<meta property="og:url" content="https://shannonhung.github.io/posts/terraform-guide/">
<meta property="og:site_name" content="Shannon&#39;s Blog ğŸŸ æŠ€è¡“ | ç”Ÿæ´» | æ—…è¡Œ">
<meta property="og:description" content="ä»‹ç´¹ Terraform æ˜¯ç”± HashiCorp é–‹ç™¼çš„ä¸€ç¨®IaCç®¡ç†å·¥å…·ï¼Œå…¶èª•ç”Ÿçš„åŸå› ä¾†è‡ªç¾ä»£ IT åŸºç¤è¨­æ–½ç®¡ç†ä¸­å°è‡ªå‹•åŒ–ã€å¯é‡è¤‡æ€§å’Œè·¨å¹³å°æ”¯æŒçš„éœ€æ±‚ã€‚éš¨è‘—é›²è¨ˆç®—çš„æ™®åŠï¼Œä¼æ¥­çš„åŸºç¤è¨­æ–½è®Šå¾—è¶Šä¾†è¶Šå‹•æ…‹ï¼Œç®¡ç†å¤šé›²ç’°å¢ƒï¼ˆå¦‚ AWSã€Azureã€Google Cloudï¼‰å’Œæœ¬åœ°æ•¸æ“šä¸­å¿ƒçš„è³‡æºè®Šå¾—è¤‡é›œä¸”å®¹æ˜“å‡ºéŒ¯ã€‚å‚³çµ±çš„æ‰‹å‹•é…ç½®æ–¹å¼ä¸åƒ…æ•ˆç‡ä½ï¼Œé‚„å®¹æ˜“å°è‡´ç’°å¢ƒä¹‹é–“çš„ä¸ä¸€è‡´ã€‚ Terraform çš„ç”¢ç”Ÿä¸»è¦">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://shannonhung.github.io/img/cover/terraform.png">
<meta property="article:published_time" content="2024-11-22T07:56:35.000Z">
<meta property="article:modified_time" content="2024-11-28T13:12:08.245Z">
<meta property="article:author" content="Shannon Hung">
<meta property="article:tag" content="Terraform">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://shannonhung.github.io/img/cover/terraform.png"><link rel="shortcut icon" href="/img/shannon-icon.png"><link rel="canonical" href="https://shannonhung.github.io/posts/terraform-guide/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="IAmwAuWZP3fXPtoYru7VJBancFMT2BkhN15HC2iea1o"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-XBNKVVH2P4"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XBNKVVH2P4');
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":-1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è©¢çš„å…§å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'è¤‡è£½æˆåŠŸ',
    error: 'è¤‡è£½éŒ¯èª¤',
    noSupport: 'ç€è¦½å™¨ä¸æ”¯æ´'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'å‰›å‰›',
    min: 'åˆ†é˜å‰',
    hour: 'å°æ™‚å‰',
    day: 'å¤©å‰',
    month: 'å€‹æœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"ä½ å·²åˆ‡æ›ç‚ºç¹é«”ä¸­æ–‡","cht_to_chs":"ä½ å·²åˆ‡æ›ç‚ºç°¡é«”ä¸­æ–‡","day_to_night":"ä½ å·²åˆ‡æ›ç‚ºæ·±è‰²æ¨¡å¼","night_to_day":"ä½ å·²åˆ‡æ›ç‚ºæ·ºè‰²æ¨¡å¼","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'è¼‰å…¥æ›´å¤š'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Terraform æ–°æ‰‹ä»‹ç´¹ - ä¸€ç¯‡ç«‹åˆ»ææ‡‚ Terrafrom çš„æ ¸å¿ƒèˆ‡åŸºç¤å…ƒä»¶',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-28 21:12:08'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/background.css"><link rel="shortcut icon" href="#"/><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+TC&display=swap" rel="stylesheet"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/loading-icon.gif" data-original="/img/dudu-me.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">122</div></a><a href="/tags/"><div class="headline">æ¨™ç±¤</div><div class="length-num">76</div></a><a href="/categories/"><div class="headline">åˆ†é¡</div><div class="length-num">40</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> ç›®éŒ„</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> é—œæ–¼æˆ‘</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> ç›¸é—œé€£çµ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> æ‰¾æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ¨™ç±¤</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ–‡ç« </span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-language"></i><span> èªè¨€</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="/"><i class="fa-fw fas fa-c"></i><span> ä¸­æ–‡</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/cover/terraform.png')"><nav id="nav"><span id="blog-info"><a href="/" title="Shannon's Blog ğŸŸ æŠ€è¡“ | ç”Ÿæ´» | æ—…è¡Œ"><span class="site-name">Shannon's Blog ğŸŸ æŠ€è¡“ | ç”Ÿæ´» | æ—…è¡Œ</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> æœå°‹</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é </span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> ç›®éŒ„</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> é—œæ–¼æˆ‘</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> ç›¸é—œé€£çµ</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> æ‰¾æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> æ¨™ç±¤</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ–‡ç« </span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-language"></i><span> èªè¨€</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/en/"><i class="fa-fw fas fa-e"></i><span> English</span></a></li><li><a class="site-page child" href="/"><i class="fa-fw fas fa-c"></i><span> ä¸­æ–‡</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Terraform æ–°æ‰‹ä»‹ç´¹ - ä¸€ç¯‡ç«‹åˆ»ææ‡‚ Terrafrom çš„æ ¸å¿ƒèˆ‡åŸºç¤å…ƒä»¶</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">ç™¼è¡¨æ–¼</span><time class="post-meta-date-created" datetime="2024-11-22T07:56:35.000Z" title="ç™¼è¡¨æ–¼ 2024-11-22 15:56:35">2024-11-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°æ–¼</span><time class="post-meta-date-updated" datetime="2024-11-28T13:12:08.245Z" title="æ›´æ–°æ–¼ 2024-11-28 21:12:08">2024-11-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%B7%A5%E5%85%B7/">å·¥å…·</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%B7%A5%E5%85%B7/Terraform/">Terraform</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•¸ç¸½è¨ˆ:</span><span class="word-count">4.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é–±è®€æ™‚é•·:</span><span>16åˆ†é˜</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Terraform æ–°æ‰‹ä»‹ç´¹ - ä¸€ç¯‡ç«‹åˆ»ææ‡‚ Terrafrom çš„æ ¸å¿ƒèˆ‡åŸºç¤å…ƒä»¶"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é–±è®€é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è©•è«–æ•¸:</span><a href="/posts/terraform-guide/#post-comment"><span class="gitalk-comment-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Terraform/">Terraform</a></div></div><article class="post-content" id="article-container"><h1 id="ä»‹ç´¹">ä»‹ç´¹</h1>
<p>Terraform æ˜¯ç”± HashiCorp é–‹ç™¼çš„ä¸€ç¨®<strong>IaCç®¡ç†å·¥å…·</strong>ï¼Œå…¶èª•ç”Ÿçš„åŸå› ä¾†è‡ªç¾ä»£ IT åŸºç¤è¨­æ–½ç®¡ç†ä¸­å°è‡ªå‹•åŒ–ã€å¯é‡è¤‡æ€§å’Œè·¨å¹³å°æ”¯æŒçš„éœ€æ±‚ã€‚éš¨è‘—é›²è¨ˆç®—çš„æ™®åŠï¼Œä¼æ¥­çš„åŸºç¤è¨­æ–½è®Šå¾—è¶Šä¾†è¶Šå‹•æ…‹ï¼Œç®¡ç†å¤šé›²ç’°å¢ƒï¼ˆå¦‚ AWSã€Azureã€Google Cloudï¼‰å’Œæœ¬åœ°æ•¸æ“šä¸­å¿ƒçš„è³‡æºè®Šå¾—è¤‡é›œä¸”å®¹æ˜“å‡ºéŒ¯ã€‚å‚³çµ±çš„æ‰‹å‹•é…ç½®æ–¹å¼ä¸åƒ…æ•ˆç‡ä½ï¼Œé‚„å®¹æ˜“å°è‡´ç’°å¢ƒä¹‹é–“çš„ä¸ä¸€è‡´ã€‚</p>
<p>Terraform çš„ç”¢ç”Ÿä¸»è¦ç‚ºäº†è§£æ±ºä»¥ä¸‹éœ€æ±‚ï¼š</p>
<ol>
<li><strong>åŸºç¤è¨­æ–½å³ä»£ç¢¼ (IaC)</strong>ï¼šæä¾›ä¸€ç¨®ç·¨ç¨‹å¼æ–¹æ³•ä¾†å®šç¾©å’Œç®¡ç†åŸºç¤è¨­æ–½ï¼Œä½¿å¾—è³‡æºé…ç½®ç‰ˆæœ¬åŒ–ã€å¯å¯©æ ¸ï¼Œä¸¦æ˜“æ–¼å¾©ç¾ã€‚</li>
<li><strong>å¤šé›²æ”¯æŒ</strong>ï¼šå…è¨±ç”¨æˆ¶é€šéå–®ä¸€å·¥å…·ç®¡ç†ä¸åŒé›²å¹³å°å’Œä¾›æ‡‰å•†çš„è³‡æºï¼Œé¿å…éåº¦ä¾è³´å–®ä¸€ä¾›æ‡‰å•†ã€‚</li>
<li><strong>å¯é‡è¤‡æ€§å’Œè‡ªå‹•åŒ–</strong>ï¼šä½¿ç”¨ä»£ç¢¼ç·¨å¯«ä¸€æ¬¡é…ç½®ï¼Œç„¡è«–æ˜¯æ¸¬è©¦ç’°å¢ƒé‚„æ˜¯ç”Ÿç”¢ç’°å¢ƒéƒ½å¯ä»¥ä¸€è‡´åœ°éƒ¨ç½²è³‡æºã€‚</li>
<li><strong>ä¾è³´ç®¡ç†</strong>ï¼šTerraform èƒ½å¤ åˆ†æåŸºç¤è¨­æ–½è³‡æºä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼ŒæŒ‰æ­£ç¢ºé †åºå‰µå»ºæˆ–åˆªé™¤è³‡æºï¼Œæ¸›å°‘äººç‚ºéŒ¯èª¤ã€‚</li>
</ol>
<p>å› æ­¤ï¼ŒTerraform çš„å‡ºç¾ä½¿ä¼æ¥­èƒ½å¤ æ›´é«˜æ•ˆåœ°ç®¡ç†å’Œé‹ç‡Ÿç¾ä»£åŒ–çš„åŸºç¤è¨­æ–½ï¼ŒåŒæ™‚åŠ å¼·äº†æ•æ·æ€§å’Œç©©å®šæ€§ã€‚ä½¿ç”¨Terrafromæˆ‘å€‘å°±ä¸éœ€è¦æ‰‹å‹•å»å»ºç«‹æˆ–æ˜¯åˆªé™¤æŸå€‹è³‡æºï¼Œåªéœ€è¦å¯«å¥½è…³æœ¬ï¼Œå°±å¯ä»¥åœ¨ä¸åŒçš„ç’°å¢ƒä¸­éƒ¨ç½²ç›¸åŒçš„è³‡æºã€‚</p>
<h1 id="IaC-å·¥å…·å·®ç•°">IaC å·¥å…·å·®ç•°</h1>
<div class="note info flat"><p>è¬›åˆ°IaCå·¥å…·ï¼Œä¸å…ä¹Ÿæœƒè½åˆ°Ansibleæˆ–æ˜¯Chefç­‰ç­‰ï¼Œé‚£é€™äº›å·¥å…·èˆ‡Terraformæœ‰ä»€éº¼ä¸åŒå‘¢ï¼Ÿ</p>
</div>
<p>Ansibleã€Chef å’Œ Terraform éƒ½æ˜¯åŸºç¤è¨­æ–½å³ä»£ç¢¼ï¼ˆIaCï¼‰å·¥å…·ï¼Œä½†å®ƒå€‘çš„è¨­è¨ˆç›®æ¨™å’Œæ‡‰ç”¨å ´æ™¯æœ‰å¾ˆå¤§çš„ä¸åŒã€‚<br>
ä»¥ä¸‹æ˜¯ Terraform èˆ‡ Ansible å’Œ Chef çš„ä¸»è¦å·®ç•°ï¼š</p>
<p><strong>å·¥å…·é¡å‹å’ŒåŠŸèƒ½ç¯„åœ</strong></p>
<ul>
<li><code>Terraform</code>ï¼š
<ul>
<li>æ˜¯ä¸€ç¨®<em>å®£å‘Šå¼çš„åŸºç¤è¨­æ–½ç·¨æ’å·¥å…·ï¼Œå°ˆæ³¨æ–¼è³‡æºçš„å‰µå»ºã€æ›´æ–°å’ŒéŠ·æ¯€</em>ã€‚</li>
<li>å®ƒçš„æ ¸å¿ƒç”¨é€”æ˜¯ç®¡ç†åŸºç¤è¨­æ–½ï¼ˆå¦‚é›²è³‡æºã€ç¶²çµ¡è¨­ç½®ç­‰ï¼‰ï¼Œç”¨æˆ¶å®šç¾©ç›®æ¨™ç‹€æ…‹ã€‚</li>
<li>ä¾‹å­ï¼šé©ç”¨æ–¼å‰µå»ºå’Œç®¡ç†åŸºç¤è¨­æ–½è³‡æºï¼ˆå¦‚è™›æ“¬æ©Ÿã€ç¶²çµ¡è¨­ç½®ã€å­˜å„²æ¡¶ç­‰ï¼‰ï¼Œä¸¦åœ¨å¤šé›²ç’°å¢ƒä¸­å¯¦ç¾çµ±ä¸€çš„åŸºç¤è¨­æ–½ç®¡ç†ã€‚</li>
</ul>
</li>
<li><code>Ansible</code> å’Œ <code>Chef</code>ï¼š
<ul>
<li>ä¸»è¦æ˜¯<em>é…ç½®ç®¡ç†å·¥å…·</em>ï¼Œç”¨æ–¼<em>å®‰è£è»Ÿé«”ã€ç®¡ç†ç³»çµ±é…ç½®ä»¥åŠæŒçºŒæ€§åœ°ç¶­è­·æ‡‰ç”¨ç¨‹åºçš„ç‹€æ…‹</em>ã€‚</li>
<li>å®ƒå€‘çš„ä½œç”¨åœ¨æ–¼é…ç½®å·²ç¶“å­˜åœ¨çš„è³‡æºï¼Œè€Œä¸æ˜¯å‰µå»ºè³‡æºã€‚</li>
<li>ä¾‹å­ï¼šæ›´é©åˆæ–¼é…ç½®æ“ä½œç³»çµ±ã€éƒ¨ç½²æ‡‰ç”¨ç¨‹åºã€å®‰è£å’Œç¶­è­·è»Ÿé«”ï¼ˆå¦‚è¨­ç½®æœå‹™å™¨çš„é˜²ç«ç‰†è¦å‰‡æˆ–å®‰è£ç‰¹å®šç‰ˆæœ¬çš„è»Ÿä»¶åŒ…ï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><strong>å®£å‘Šå¼ vs æŒ‡ä»¤å¼</strong></p>
<ul>
<li><code>Terraform</code>ï¼š
<ul>
<li>æ˜¯å®£å‘Šå¼çš„ï¼Œç”¨æˆ¶åªéœ€å®šç¾©åŸºç¤è¨­æ–½çš„<em>æœ€çµ‚ç‹€æ…‹</em>ï¼Œå…·é«”å¦‚ä½•åŸ·è¡Œç”± Terraform è™•ç†ã€‚</li>
</ul>
</li>
<li><code>Ansible</code> å’Œ <code>Chef</code>ï¼š
<ul>
<li>é€šå¸¸æ˜¯æŒ‡ä»¤å¼çš„ï¼Œç”¨æˆ¶éœ€è¦<em>æ˜ç¢ºå®šç¾©åŸ·è¡Œçš„æ­¥é©Ÿ</em></li>
<li>ä¾‹å¦‚ã€Œå…ˆå®‰è£ Nginxï¼Œç„¶å¾Œä¿®æ”¹é…ç½®æª”ï¼Œå†å•Ÿå‹•æœå‹™ã€ã€‚</li>
<li>é€™å°æ–¼è¤‡é›œçš„æ“ä½œæµç¨‹æ›´ç‚ºéˆæ´»ï¼Œä½†éœ€è¦æ›´å¤šçš„ç´°ç¯€ç®¡ç†ã€‚</li>
</ul>
</li>
</ul>
<h1 id="Terraform-æµç¨‹">Terraform æµç¨‹</h1>
<p><img src="/img/loading-icon.gif" data-original="/img/figure/tf-flow.png" alt=""></p>
<p><strong>æŒ‡ä»¤ä¸»è¦</strong>æœ‰ä»¥ä¸‹å¹¾å€‹ï¼š</p>
<ul>
<li><code>terraform init</code>ï¼šåˆå§‹åŒ–å·¥ä½œç›®éŒ„ï¼Œä¸‹è¼‰ provider æ’ä»¶ã€‚</li>
<li><code>terraform validate</code>ï¼šé©—è­‰é…ç½®æ–‡ä»¶çš„èªæ³•å’Œé‚è¼¯éŒ¯èª¤ã€‚</li>
<li><code>terraform fmt</code>ï¼šæ ¼å¼åŒ–é…ç½®æ–‡ä»¶ï¼Œä½¿å…¶ç¬¦åˆ Terraform çš„æ¨™æº–æ ¼å¼ï¼Œé€™å€‹æŒ‡ä»¤æœƒå¹«ä½ é‡æ–°æ’ç‰ˆã€‚</li>
<li><code>terraform plan</code>ï¼šç”Ÿæˆè¨ˆåŠƒï¼Œå¯ä»¥é è¦½å°‡è¦åŸ·è¡Œçš„æ“ä½œã€‚ä½†æ˜¯ä¸æœƒçœŸæ­£å‰µå»ºæˆ–æ›´æ–°åŸºç¤è¨­æ–½ã€‚</li>
<li><code>terraform apply</code>ï¼šæ‡‰ç”¨è¨ˆåŠƒï¼Œå‰µå»ºæˆ–æ›´æ–°åŸºç¤è¨­æ–½ã€‚</li>
<li><code>terraform destroy</code>ï¼šåˆªé™¤åŸºç¤è¨­æ–½ï¼Œé€šå¸¸ç”¨æ–¼æ¸¬è©¦ç’°å¢ƒçš„æ¸…ç†ã€‚</li>
</ul>
<p><strong>å…¶ä»–åƒæ•¸è¨­å®š</strong>ï¼š</p>
<ul>
<li><code>-auto-approve</code>
<ul>
<li>å¯ä»¥è‡ªå‹•è·³éé€™å€‹ç¢ºèªæ­¥é©Ÿï¼Œç›´æ¥æ‡‰ç”¨è¨ˆç•«ï¼Œé©åˆè‡ªå‹•åŒ–è…³æœ¬æˆ– CI/CD æµç¨‹ã€‚</li>
<li>ç•¶ä½ åŸ·è¡Œ terraform apply æ™‚ï¼ŒTerraform æœƒé è¨­è¦æ±‚ç”¨æˆ¶æ‰‹å‹•ç¢ºèª (yes) æ‰æœƒåŸ·è¡Œè¨ˆç•« (plan) ä¸­çš„è®Šæ›´ã€‚</li>
</ul>
</li>
<li><code>plain.out</code>
<ul>
<li>ä½ å¯ä»¥å…ˆä½¿ç”¨ <code>terraform plan -out=plan.out</code> ç”Ÿæˆè¨ˆç•«æ–‡ä»¶ï¼Œè©²<em>æ–‡ä»¶è©³ç´°è¨˜éŒ„äº†</em> Terraform å°‡åŸ·è¡Œçš„æ“ä½œï¼ˆä¾‹å¦‚è³‡æºæ–°å¢ã€åˆªé™¤æˆ–ä¿®æ”¹ï¼‰ã€‚</li>
<li>åœ¨ terraform apply æ™‚æŒ‡å®šè©²æ–‡ä»¶ï¼ˆå¦‚ <code>terraform apply plan.out</code>ï¼‰ï¼Œå¯ä¿è­‰æ‡‰ç”¨çš„è¨ˆç•«å’Œç”Ÿæˆæ™‚ä¸€è‡´ï¼Œé¿å…éé æœŸçš„æ›´æ”¹ã€‚</li>
<li>ç°¡å–®ä¾†èªªï¼Œæˆ‘å€‘æœƒå»ºè­°<code>terraform plan -out plan.out</code>ï¼Œç„¶å¾Œå†<code>terraform apply -auto-approve plan.out</code>ï¼Œ<em>é€™æ¨£å¯ä»¥ç¢ºä¿ <code>apply</code> çš„çµæœæ˜¯æ ¹æ“š <code>plan</code> ä¾†çš„</em>ã€‚</li>
</ul>
</li>
</ul>
<p>æˆ‘å€‘å¯ä»¥è¨­å®šaliasåœ¨ <code>~/.bashrc</code>ï¼Œé€™æ¨£å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ç°¡å¯«æŒ‡ä»¤ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¨­å®šaliasåœ¨ vim ~/.bashrc</span></span><br><span class="line"><span class="built_in">alias</span> tf=<span class="string">&quot;terraform&quot;</span></span><br><span class="line"><span class="built_in">alias</span> tfv=<span class="string">&quot;terraform validate&quot;</span></span><br><span class="line"><span class="built_in">alias</span> tfp=<span class="string">&quot;terraform plan -out plan.out&quot;</span></span><br><span class="line"><span class="built_in">alias</span> tfdp=<span class="string">&quot;terraform apply -auto-approve plan.out&quot;</span></span><br><span class="line"><span class="built_in">alias</span> tfd=<span class="string">&quot;terraform apply -auto-approve&quot;</span></span><br><span class="line"><span class="built_in">alias</span> tfr=<span class="string">&quot;terraform destroy -auto-approve&quot;</span></span><br></pre></td></tr></table></figure>
<h1 id="æ ¸å¿ƒå…ƒä»¶">æ ¸å¿ƒå…ƒä»¶</h1>
<p><img src="/img/loading-icon.gif" data-original="/img/figure/tf-core.png" alt=""><br>
ä»¥ä¸‹æ˜¯å°åœ–ç‰‡ä¸­æ¯å€‹ Terraform å…ƒä»¶çš„ç°¡å–®ä»‹ç´¹èˆ‡ç”¨é€”èªªæ˜ï¼š</p>
<h1 id="åŸºç¤ç¯‡">åŸºç¤ç¯‡</h1>
<h2 id="1-Providers-ä¾›æ‡‰å•†">1. Providers (ä¾›æ‡‰å•†)</h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼š
<ul>
<li>è² è²¬èˆ‡ç‰¹å®šçš„é›²ç«¯å¹³å°ï¼ˆå¦‚ AWSã€Azureã€Google Cloudï¼‰æˆ–æœå‹™ï¼ˆå¦‚ Kubernetesï¼‰äº’å‹•ã€‚å®ƒæä¾› API çš„æ©‹æ¨‘ï¼Œå…è¨± Terraform ç®¡ç†é€™äº›è³‡æºã€‚</li>
<li>å¯ä»¥æŒ‡å®š provider ç‰ˆæœ¬ï¼ˆ<code>æœ€ä½³å¯¦ä½œ</code>ï¼‰ï¼Œä»¥ç¢ºä¿ Terraform èˆ‡ç‰¹å®šç‰ˆæœ¬çš„ provider å…¼å®¹ã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>ï¼šAWS Provider å¹«åŠ©å‰µå»º EC2ã€S3 ç­‰è³‡æºã€‚</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">terraform &#123;</span><br><span class="line">    required_providers &#123;</span><br><span class="line">        google = &#123;</span><br><span class="line">        source  = &quot;hashicorp/google&quot;</span><br><span class="line">        version = &quot;&gt;= 4.40.0&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-Resource-è³‡æº">2. Resource (è³‡æº)</h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼š
<ul>
<li>æè¿°è¦ç®¡ç†çš„åŸºç¤è¨­æ–½è³‡æºï¼Œæ˜¯ Terraform çš„æ ¸å¿ƒçµ„ä»¶ã€‚ä¾‹å¦‚ EC2 å¯¦ä¾‹ã€S3 å­˜å„²æ¡¶ã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;aws_instance&quot; &quot;example&quot; &#123;</span><br><span class="line">    ami           = &quot;ami-12345678&quot;</span><br><span class="line">    instance_type = &quot;t2.micro&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-Provisioners-é…ç½®å™¨">3. Provisioners (é…ç½®å™¨)</h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼š
<ul>
<li>å¿…é ˆæ”¾åœ¨Resourceè£¡é¢</li>
<li>ç”¨æ–¼åœ¨è³‡æºå»ºç«‹å¾ŒåŸ·è¡Œé¡å¤–çš„é…ç½®æ­¥é©Ÿï¼ˆå¦‚åŸ·è¡Œè…³æœ¬ã€å®‰è£è»Ÿé«”ï¼‰ã€‚</li>
<li>æ‡‰è©²è¬¹æ…ä½¿ç”¨ï¼Œå› ç‚ºå®ƒå€‘é•åäº†è²æ˜å¼çš„ç†å¿µã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>ï¼šåœ¨ EC2 ä¸ŠåŸ·è¡Œåˆå§‹åŒ–è…³æœ¬ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">resource &quot;google_compute_instance&quot; &quot;example&quot; &#123;</span><br><span class="line">  name         = &quot;example-instance&quot;</span><br><span class="line">  machine_type = &quot;e2-micro&quot;</span><br><span class="line">  zone         = &quot;asia-east1-b&quot;</span><br><span class="line"></span><br><span class="line">  boot_disk &#123;</span><br><span class="line">    initialize_params &#123;</span><br><span class="line">      image = &quot;debian-cloud/debian-10&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  network_interface &#123;</span><br><span class="line">    network = &quot;default&quot;</span><br><span class="line"></span><br><span class="line">    access_config &#123;</span><br><span class="line">      // Ephemeral IP</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">##################################################################################</span><br><span class="line"># PROVISIONER</span><br><span class="line">##################################################################################</span><br><span class="line">  # æˆåŠŸæ¡ˆä¾‹ï¼ŒåŸ·è¡Œé›»è…¦æœ¬æ©Ÿè·¯å¾‘</span><br><span class="line">  provisioner &quot;local-exec&quot; &#123;</span><br><span class="line">    command = &quot;echo $&#123;google_compute_instance.example.network_interface[0].network_ip&#125; &gt; ./ip_address_local_exec.txt&quot;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  # # å‚³é€åˆ°è™›æ“¬é›»è…¦æœ¬æ©Ÿ(é€™å°é›»è…¦è¦å…ˆèƒ½é€šéå»ä¸¦ä¸”ssh)</span><br><span class="line">  # provisioner &quot;file&quot; &#123;</span><br><span class="line">  #   content     = google_compute_instance.example.network_interface[0].network_ip</span><br><span class="line">  #   destination = &quot;/tmp/ip_address_file.txt&quot;</span><br><span class="line">  # &#125;</span><br><span class="line"></span><br><span class="line">  # # ç„¡æ³•é€£ç·šåˆ°é ç«¯(é€™å°é›»è…¦è¦å…ˆèƒ½é€šéå»ä¸¦ä¸”ssh)</span><br><span class="line">  # provisioner &quot;remote-exec&quot; &#123;</span><br><span class="line">  #   inline = [</span><br><span class="line">  #     &quot;echo $&#123;google_compute_instance.example.network_interface[0].network_ip&#125; &gt; /tmp/ip_address_remote_exec.txt&quot;</span><br><span class="line">  #   ]</span><br><span class="line">  # &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-Variables-è®Šæ•¸"><strong>4. Variables (è®Šæ•¸)</strong></h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼š
<ul>
<li>ç”¨æ–¼è¨­ç½® Terraform æ¨¡çµ„çš„åƒæ•¸ï¼Œè®Šæ•¸å¯ä»¥ç”¨ä¾†å‚³éå€¼åˆ°æ¨¡çµ„ä¸­ï¼Œåƒæ˜¯æŒ‡å®š GCP å°ˆæ¡ˆ ID æˆ– AWS å¯†é‘°ã€‚</li>
<li>é€™ç¨®æ–¹å¼ç¨±ç‚º<em>ä¾è³´æ³¨å…¥</em>å¯ä»¥ä½¿ç”¨è®Šæ•¸ä¾†æŒ‡å®šé–‹ç™¼ç’°å¢ƒã€ç”Ÿç”¢ç’°å¢ƒç­‰ä¸åŒçš„é…ç½®ã€‚</li>
<li>å¯ä»¥å®šç¾©ä¸åŒé¡å‹çš„è®Šæ•¸ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²ã€æ•¸å­—ã€å¸ƒæ—å€¼ç­‰ã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>ï¼šè¨­å®š GCP å°ˆæ¡ˆ ID å’Œ GCS å­˜å„²æ¡¶åç¨±ï¼š</li>
</ul>
<blockquote>
<p><code>variables.tf</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"># æˆ‘å€‘ä¸»è¦æœ‰ä¸‰å€‹è®Šæ•¸åç¨±ï¼šGCP_PROJECTã€gcs_nameã€location</span><br><span class="line">variable &quot;GCP_PROJECT&quot; &#123;</span><br><span class="line">  type        = string</span><br><span class="line">  description = &quot;GCP project ID&quot;</span><br><span class="line">  default     = &quot;terraform101-442105&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">variable &quot;gcs_name&quot; &#123;</span><br><span class="line">  type    = string</span><br><span class="line">  default = &quot;quick-start-gcs-bucket-variable&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">variable &quot;location&quot; &#123;</span><br><span class="line">  type    = string</span><br><span class="line">  default = &quot;asia-east1&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>main.tf</code></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ var.&lt;variable-name&gt; ä¾†å–å¾—å€¼</span><br><span class="line">terraform &#123;</span><br><span class="line">  required_version = &quot;&gt;=1.0&quot;</span><br><span class="line"></span><br><span class="line">  required_providers &#123;</span><br><span class="line">    google = &#123;</span><br><span class="line">      source  = &quot;hashicorp/google&quot;</span><br><span class="line">      version = &quot;&gt;=4.40.0&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">provider &quot;google&quot; &#123;</span><br><span class="line">  project = var.GCP_PROJECT</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">resource &quot;google_storage_bucket&quot; &quot;quick_start_gcs&quot; &#123;</span><br><span class="line">  name          = var.gcs_name</span><br><span class="line">  location      = var.location</span><br><span class="line">  force_destroy = true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä½¿ç”¨console æ¸¬è©¦è®Šæ•¸</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ tf console </span><br><span class="line">$ var.location  <span class="comment"># æœƒå°å‡º asia-east1</span></span><br></pre></td></tr></table></figure>
<h3 id="è®Šæ•¸å‹æ…‹">è®Šæ•¸å‹æ…‹</h3>
<table>
<thead>
<tr>
<th>å­ä¸²</th>
<th>å¯«æ³•</th>
<th>ç¯„ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>å­—ä¸²</td>
<td><code>type=string</code></td>
<td>us-west-1</td>
</tr>
<tr>
<td>æ•¸å€¼</td>
<td><code>type=number</code></td>
<td>1</td>
</tr>
<tr>
<td>å¸ƒæ—</td>
<td><code>type=bool</code></td>
<td>true, false</td>
</tr>
<tr>
<td>åˆ—è¡¨(å‹æ…‹)</td>
<td><code>type=list(string)</code></td>
<td>[â€œaâ€, â€œbâ€, â€œcâ€]</td>
</tr>
<tr>
<td>åœ°åœ–(å‹æ…‹)</td>
<td><code>type=map(string)</code></td>
<td>{ key = â€œvalueâ€ }</td>
</tr>
</tbody>
</table>
<h3 id="è®Šæ•¸ç¹¼æ‰¿é †åº">è®Šæ•¸ç¹¼æ‰¿é †åº</h3>
<p>è®Šæ•¸å¯ä»¥åœ¨å¤šå€‹åœ°æ–¹å®šç¾©ï¼Œä¸¦ä¸”æœ‰ä¸€å®šçš„ç¹¼æ‰¿é †åºï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<ol>
<li><em>å‘½ä»¤è¡Œåƒæ•¸</em>ï¼ˆå¦‚ <code>-var 'foo=bar'</code>ï¼‰ï¼šå„ªå…ˆæ¬Šæœ€é«˜ï¼Œå¯ä»¥è¦†è“‹æ‰€æœ‰å…¶ä»–å€¼ã€‚</li>
<li><em>Terraform ç’°å¢ƒè®Šæ•¸</em>
<ul>
<li>Terraform å¯ä»¥ç›´æ¥è®€å–ç’°å¢ƒè®Šæ•¸ï¼Œå°¤å…¶æ˜¯èˆ‡æä¾›å•†ç›¸é—œçš„èªè­‰å’Œé…ç½®ã€‚ç’°å¢ƒè®Šæ•¸é€šå¸¸æ˜¯ä»¥ <code>TF_VAR_</code> ç‚ºå‰ç¶´çš„ï¼Œå¾Œé¢è·Ÿè®Šæ•¸åç¨±ã€‚</li>
<li><code>export TF_VAR_region=&quot;asia-northeast1&quot;</code> è¼¸å…¥å¾Œï¼Œå°±å¯ä»¥åœ¨ Terraform ä¸­ä½¿ç”¨ <code>var.region</code> ä¾†å–å¾—å€¼ã€‚æˆ–æ˜¯ç›´æ¥ä½¿ç”¨<code>variable &quot;region&quot; &#123;&#125;</code>è‡ªå‹•å¸¶å…¥ã€‚</li>
</ul>
</li>
<li><em>Terraform è®Šæ•¸æ–‡ä»¶</em>
<ul>
<li><code>terraform.tfvars</code> ä¸­ç›´æ¥è¨­ç½® <code>key=value</code> çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®€å–ã€‚ä¾‹å¦‚: <code>region = &quot;asia-northeast1&quot;</code></li>
<li>ä½¿ç”¨çš„æ–¹å¼å¯ä»¥åœ¨<code>variable.tf</code>æª”æ¡ˆè¨­ç½®å¦‚ä¸‹ï¼š<code>variable &quot;region&quot; &#123; type=string &#125;</code> å°±ä¸ç”¨æŒ‡å®šdefaultäº†ï¼Œå„˜ç®¡æœ‰æŒ‡å®šä¹Ÿæœƒè¢«è¦†è“‹æ‰ã€‚</li>
</ul>
</li>
<li><em>Terraform è¨­å®šæ–‡ä»¶</em>
<ul>
<li>åŸºæœ¬ä¸Šå°±æ˜¯<code>variable.tf</code>è£¡é¢æˆ‘å€‘æœƒè¨­å®š<code>variable &quot;region&quot; &#123; type=string default=&quot;asia-northeast1&quot; &#125;</code>ï¼Œé€™æ¨£å°±å¯ä»¥ç›´æ¥ä½¿ç”¨äº†ã€‚</li>
</ul>
</li>
</ol>
<h2 id="5-Data-Source-è³‡æ–™ä¾†æº"><strong>5. Data Source (è³‡æ–™ä¾†æº)</strong></h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼š
<ul>
<li>ç•¶éœ€è¦ä½¿ç”¨ç¾æœ‰åŸºç¤è¨­æ–½ï¼Œåƒæ˜¯ç¾æœ‰çš„PVC, å­ç¶², instanceç­‰ï¼Œå¯ä»¥ä½¿ç”¨data sourceä¾†å–å¾—è³‡è¨Šä¸¦å¼•ç”¨ã€‚</li>
<li>å¾ä»¥ä¸‹ç¯„ä¾‹ç‚ºä¾‹ï¼Œæˆ‘å€‘ä½¿ç”¨<code>google_client_config</code>é€™å€‹ data soucr æª¢ç´¢ç•¶å‰Google Cloud å®¢æˆ¶ç«¯é…ç½®çš„ç›¸é—œè³‡è¨Šï¼Œå¯ä»¥å–å¾—ç›®å‰æ­£åœ¨ä½¿ç”¨çš„å°ˆæ¡ˆIDã€å€åŸŸã€ç”¨æˆ¶å¸³æˆ¶ç­‰ã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>ï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨ data source å–å¾— Google Cloud å®¢æˆ¶ç«¯é…ç½® é è¨­æœå‹™å¸³æˆ¶</span><br><span class="line">data &quot;google_client_config&quot; &quot;default&quot; &#123;&#125;</span><br><span class="line">data &quot;google_compute_default_service_account&quot; &quot;default&quot; &#123;&#125; # ç”¨æ–¼æª¢ç´¢èˆ‡ç•¶å‰ Google Cloud é …ç›®ç›¸é—œè¯çš„é»˜èªæœå‹™å¸³æˆ¶ï¼ˆservice accountï¼‰</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ data source å–å¾—å°ˆæ¡ˆ ID å’Œå€åŸŸ</span><br><span class="line">output &quot;project_id&quot; &#123;</span><br><span class="line">  value = data.google_client_config.default.project</span><br><span class="line">&#125;</span><br><span class="line">output &quot;region&quot; &#123;</span><br><span class="line">  value = data.google_client_config.default.region</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ data source å–å¾—é è¨­æœå‹™å¸³æˆ¶</span><br><span class="line">module &quot;gke&quot; &#123;</span><br><span class="line">  ...</span><br><span class="line">  service_account = data.google_compute_default_service_account.default.email</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœæƒ³è¦å–å¾—<code>bucket</code>çš„ç›¸é—œdata souceå‰‡è¦ç¢ºä¿<code>name</code>è¦æ˜¯å­˜åœ¨çš„ï¼Œå¦å‰‡æœƒå ±éŒ¯ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;google_storage_bucket&quot; &quot;bucket&quot; &#123;</span><br><span class="line">  name          = &quot;my-new-bucket&quot; # å»ºç«‹ä¸€å€‹ bucket åç¨±ç‚º my-new-bucket</span><br><span class="line">  location      = &quot;US&quot;</span><br><span class="line">  force_destroy = true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data &quot;google_storage_bucket&quot; &quot;my-new-bucket&quot; &#123;  # å–å¾— bucket åç¨±ç‚º my-new-bucket çš„è³‡è¨Š</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="6-Outputs-è¼¸å‡º"><strong>6. Outputs (è¼¸å‡º)</strong></h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼šå®šç¾©å¾ Terraform é…ç½®ä¸­è¼¸å‡ºçš„å€¼ï¼Œæ–¹ä¾¿å…¶ä»–æ¨¡çµ„æˆ–ç”¨æˆ¶æŸ¥çœ‹é‡è¦ä¿¡æ¯ã€‚</li>
<li><strong>ç¯„ä¾‹</strong>ï¼šå–å¾— data source çš„å…§å®¹è¼¸å‡º GCP å°ˆæ¡ˆ ID å’Œå€åŸŸï¼š</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># ä½¿ç”¨ data source å–å¾— Google Cloud å®¢æˆ¶ç«¯é…ç½® é è¨­æœå‹™å¸³æˆ¶</span><br><span class="line">data &quot;google_client_config&quot; &quot;default&quot; &#123;&#125;</span><br><span class="line">data &quot;google_compute_default_service_account&quot; &quot;default&quot; &#123;&#125; # ç”¨æ–¼æª¢ç´¢èˆ‡ç•¶å‰ Google Cloud é …ç›®ç›¸é—œè¯çš„é»˜èªæœå‹™å¸³æˆ¶ï¼ˆservice accountï¼‰</span><br><span class="line"></span><br><span class="line"># ä½¿ç”¨ data source å–å¾—å°ˆæ¡ˆ ID å’Œå€åŸŸ</span><br><span class="line">output &quot;project_id&quot; &#123;</span><br><span class="line">  value = data.google_client_config.default.project</span><br><span class="line">&#125;</span><br><span class="line">output &quot;region&quot; &#123;</span><br><span class="line">  value = data.google_client_config.default.region</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="7-State-ç‹€æ…‹"><strong>7. State (ç‹€æ…‹)</strong></h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼š
<ul>
<li>Terraform ç”¨æ–¼<em>è¿½è¹¤å·²ç®¡ç†çš„è³‡æºçš„ç•¶å‰ç‹€æ…‹</em>ï¼Œä¸¦æ¯”è¼ƒJSONé…ç½®æ–‡ä»¶çš„æœŸæœ›ç‹€æ…‹ï¼Œæ±ºå®šè³‡æºçš„å¢åˆªæ”¹æ“ä½œã€‚</li>
</ul>
</li>
<li><strong>ç®¡ç†Stateçš„æœ€ä½³å¯¦è¸</strong>
<ol>
<li>ä¸è¦æ‰‹å‹•ä¿®æ”¹ <code>tfstate</code> æ–‡ä»¶: <code>tfstate</code> æ˜¯ Terraform ç®¡ç†çš„æ ¸å¿ƒæ•¸æ“šï¼Œæ‰‹å‹•ä¿®æ”¹å¯èƒ½å°è‡´ç‹€æ…‹ä¸ä¸€è‡´æˆ–æå£ã€‚</li>
<li>ä½¿ç”¨é ç«¯å¾Œç«¯å­˜å„² ï¼ˆBackendï¼‰: åœ¨åœ˜éšŠå”ä½œæˆ–ç”Ÿç”¢ç’°å¢ƒä¸­ï¼Œå°‡ç‹€æ…‹æ–‡ä»¶å­˜å„²åˆ°å®‰å…¨çš„é ç«¯å¾Œç«¯ï¼ˆå¦‚ S3ï¼‰æ˜¯å¿…è¦çš„ã€‚</li>
<li>å•Ÿç”¨åŠ å¯†ï¼šå¦‚æœä½¿ç”¨ S3ã€GCS ç­‰å¾Œç«¯ï¼Œå•Ÿç”¨åŠ å¯†ä¾†ä¿è­·ç‹€æ…‹æ–‡ä»¶çš„æ•æ„Ÿæ•¸æ“šã€‚</li>
<li>å•Ÿç”¨ç‰ˆæœ¬æ§åˆ¶ï¼šé ç«¯å¾Œç«¯é€šå¸¸æ”¯æ´ç‰ˆæœ¬æ§åˆ¶ï¼ˆå¦‚ S3 çš„ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½ï¼‰ï¼Œå¯ä»¥ç”¨æ–¼æ¢å¾©æ„å¤–æå£çš„ç‹€æ…‹æ–‡ä»¶ã€‚</li>
<li>é–å®šç‹€æ…‹æ–‡ä»¶ï¼šä½¿ç”¨é ç«¯å¾Œç«¯ï¼ˆå¦‚ S3 æ­é… DynamoDB æˆ– Terraform Cloudï¼‰é€²è¡Œç‹€æ…‹é–å®šï¼Œé˜²æ­¢å¤šç”¨æˆ¶åŒæ™‚ä¿®æ”¹ç‹€æ…‹æ–‡ä»¶ã€‚</li>
<li>æ•æ„Ÿæ•¸æ“šç®¡ç†ï¼š<code>tfstate</code> æ–‡ä»¶å¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆå¦‚å¯†ç¢¼ã€API å¯†é‘°ï¼‰ï¼Œéœ€è¦å¦¥å–„ä¿è­·ï¼Œé¿å…å…¬é–‹æˆ–æœªåŠ å¯†å­˜å„²ã€‚</li>
</ol>
</li>
<li><strong>ç¯„ä¾‹</strong>ï¼š<br>
<img src="/img/loading-icon.gif" data-original="/img/figure/tf-state.png" alt=""></li>
</ul>
<h2 id="8-Backend-é ç«¯ç‹€æ…‹å¾Œå°"><strong>8. Backend (é ç«¯ç‹€æ…‹å¾Œå°)</strong></h2>
<ul>
<li><strong>ç”¨é€”</strong>ï¼š
<ul>
<li>å®šç¾© Terraform çš„ç‹€æ…‹æª”æ¡ˆ<code>tfstate</code>æ‡‰å­˜å„²æ–¼å“ªè£¡ï¼Œæ”¯æŒå¤šç”¨æˆ¶å”ä½œä¸¦ç™¼æ“ä½œã€‚</li>
<li>å¯ä»¥æŠŠ<code>terraform.tfstate</code>çš„ç‹€æ…‹å„²å­˜åœ¨S3, GCPç­‰ç­‰ï¼Œé€™æ¨£ä¸åƒ…åƒ…å¯ä»¥åšç‰ˆæ§ï¼Œé‚„å¯ä»¥å”åŒç·¨è¼¯ç­‰ç­‰ã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>ï¼š
<ol>
<li>é€šå¸¸åœ¨å°ˆæ¡ˆè£¡é¢å¯ä»¥é‡å°backendå»ºç«‹è³‡æ–™å¤¾<code>/state</code>ï¼Œç„¶å¾Œåœ¨è£¡é¢å»ºç«‹<code>backend.tf</code>æª”æ¡ˆå¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;google_storage_bucket&quot; &quot;quick_start_gcs&quot; &#123;</span><br><span class="line">  name          = &quot;gcs-bucket-state&quot;</span><br><span class="line">  location      = &quot;asia-east1&quot;</span><br><span class="line">  force_destroy = true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>ä¹‹å¾Œå»ºç«‹<code>terraform</code>çš„æ™‚å€™å°±å¯ä»¥æŒ‡å®šbackendå¦‚ä¸‹ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">terraform &#123;</span><br><span class="line">  backend &quot;gcs&quot; &#123;</span><br><span class="line">    bucket  = &quot;gcs-bucket-state&quot; # &lt;=== é€™é‚Šè¦å°æ‡‰åˆ°ä¸Šé¢çš„åç¨±</span><br><span class="line">    prefix  = &quot;terraform/state&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="é€²éšç¯‡">é€²éšç¯‡</h1>
<p>ä¸Šè¿°éƒ½æ˜¯æ¯”è¼ƒåŸºç¤çš„å…ƒä»¶èˆ‡è¨­å®šæ•™å­¸ï¼Œæ¥ä¸‹ä¾†å¦‚æœå°ˆæ¡ˆæ¯”è¼ƒå¤§ï¼Œå¯èƒ½æœƒéœ€è¦é€²ä¸€æ­¥ç­è§£ä»¥ä¸‹å…ƒä»¶ã€‚</p>
<ul>
<li><code>Modules</code> (æ¨¡çµ„)ï¼šæ¨¡çµ„æ˜¯å¯é‡è¤‡ä½¿ç”¨çš„é…ç½®å–®ä½ï¼ŒåŒ…å«è³‡æºã€è®Šæ•¸ç­‰å®šç¾©ï¼Œå¹«åŠ©çµ„ç¹”ä»£ç¢¼ä¸¦<em>å¯¦ç¾ä»£ç¢¼é‡ç”¨</em>ã€‚</li>
<li><code>Dependency</code> (ä¾è³´)ï¼šTerraform æœƒè‡ªå‹•è§£æè³‡æºä¹‹é–“çš„ä¾è³´é—œä¿‚ï¼Œä¸¦æŒ‰<em>æ­£ç¢ºé †åºå‰µå»ºæˆ–åˆªé™¤è³‡æº</em>ã€‚</li>
<li><code>Lifecycle</code> (ç”Ÿå‘½é€±æœŸ)ï¼š<em>æ§åˆ¶è³‡æºçš„å‰µå»ºã€æ›´æ–°å’Œåˆªé™¤è¡Œç‚º</em>ï¼Œå¦‚ä½•è™•ç†è³‡æºçš„è®Šæ›´ã€‚</li>
<li><code>Workspaces</code> (å·¥ä½œå€)ï¼š<em>ç”¨æ–¼ç®¡ç†ä¸åŒç’°å¢ƒ</em>ï¼ˆå¦‚é–‹ç™¼ã€æ¸¬è©¦ã€ç”Ÿç”¢ï¼‰çš„ç‹€æ…‹å’Œé…ç½®ï¼Œé¿å…æ··æ·†å’Œè¡çªã€‚</li>
</ul>
<h2 id="1-Modules-æ¨¡çµ„"><strong>1. Modules (æ¨¡çµ„)</strong></h2>
<ul>
<li>
<p><strong>ç”¨é€”</strong>ï¼š</p>
<ul>
<li>æ¨¡çµ„æ˜¯å¯é‡è¤‡ä½¿ç”¨çš„é…ç½®å–®ä½ï¼ŒåŒ…å«è³‡æºã€è®Šæ•¸ç­‰å®šç¾©ï¼Œå¹«åŠ©çµ„ç¹”ä»£ç¢¼ä¸¦å¯¦ç¾ä»£ç¢¼é‡ç”¨ã€‚</li>
<li>é€šå¸¸æœƒå»ºç«‹ä¸€å€‹è³‡æ–™å¤¾ç¨±ä½œ<code>./modules</code> åœ¨è£¡é¢å»ºç«‹ç›¸é—œçš„æª”æ¡ˆã€‚<br>
<img src="/img/loading-icon.gif" data-original="/img/figure/tf-module.png" alt=""></li>
</ul>
</li>
<li>
<p><strong>ç¯„ä¾‹</strong>ï¼š</p>
</li>
</ul>
<p><em>./modules/main.tf</em> è·Ÿä¸€èˆ¬è¨­å®šæ²’å…©æ¨£ï¼Œè¨­å®š resource</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;google_storage_bucket&quot; &quot;shannon_gcs&quot; &#123;</span><br><span class="line">  name          = var.gcs_name</span><br><span class="line">  location      = var.location</span><br><span class="line">  force_destroy = true</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>./modules/variable.tf</em> è·Ÿä¸€èˆ¬è¨­å®šæ²’å…©æ¨£ï¼Œè¨­å®š variable</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">variable &quot;gcs_name&quot; &#123; # å¯ä»¥é€éå¤–éƒ¨moduleå¼•å…¥è®Šæ•¸</span><br><span class="line">  type    = string</span><br><span class="line">  default = &quot;quick-start-gcs-bucket-state&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">variable &quot;location&quot; &#123;  # å¯ä»¥é€éå¤–éƒ¨moduleå¼•å…¥è®Šæ•¸</span><br><span class="line">  type    = string</span><br><span class="line">  default = &quot;asia-east1&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em>./modules/output.ts</em> æ³¨æ„çš„æ˜¯å„˜ç®¡ä½¿ç”¨ apply ä¹Ÿä¸æœƒå°å‡ºï¼Œé™¤éåœ¨<code>main.tf</code>è¨­å®šoutput</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">output &quot;bucket_name&quot; &#123;</span><br><span class="line">  value = google_storage_bucket.shannon_gcs.name</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output &quot;bucket_location&quot; &#123;</span><br><span class="line">  value = google_storage_bucket.shannon_gcs.location</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><em><a target="_blank" rel="noopener external nofollow noreferrer" href="http://main.tf">main.tf</a></em> çœŸæ­£åŸ·è¡Œ<code>terraform apply</code>çš„æª”æ¡ˆ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># å¼•ç”¨ module </span><br><span class="line">module &quot;shannon-module-gcs&quot; &#123; # å¯ä»¥è‡ªå·±å–å</span><br><span class="line">  source   = &quot;./modules/test&quot; # å¼•ç”¨çš„åœ°æ–¹</span><br><span class="line">  gcs_name = &quot;shannon-gcs-module-test&quot; # æœƒæ”¾åˆ°Moduleè£¡é¢çš„è®Šæ•¸</span><br><span class="line">  location = &quot;asia-east1&quot;# æœƒæ”¾åˆ°Moduleè£¡é¢çš„è®Šæ•¸</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ./path/output.tf éœ€è¦è¨­å®šoutput.tfæŒ‡å‘moduleçš„outputæ‰æœƒå°å‡ºæ±è¥¿</span><br><span class="line">output &quot;bucket1_name&quot; &#123;</span><br><span class="line">  value = module.shannon-module-gcs.bucket_name # æœƒå»æŠ“module.output.&lt;name&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-Dependency-ä¾è³´">2. Dependency (ä¾è³´)</h2>
<ul>
<li><strong>ç”¨é€”</strong>
<ul>
<li>æ¨¡çµ„ä¹‹é–“å¯ä»¥ç›¸äº’ä¾è³´ï¼Œä¹Ÿå¯ä»¥ç¨ç«‹å­˜åœ¨ï¼Œä¹Ÿå› æ­»å…©å€‹<em>æ¨¡çµ„ä¹‹é–“å¯èƒ½ç”¢ç”Ÿå­˜åœ¨å…ˆå¾Œçš„é—œä¿‚</em>ã€‚</li>
<li>æ¨¡çµ„ä¹‹é–“çš„ä¾è³´é—œä¿‚å¯ä»¥é€é resource æˆ– module ä¾†å»ºç«‹ã€‚</li>
<li>Terraform æœƒè‡ªå‹•è¨ˆç®—ä¾è³´é—œä¿‚ï¼Œç¢ºå®šæ¨¡çµ„çš„å‰µå»ºä»¥åŠéŠ·æ¯€çš„é †åºã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>
<ul>
<li>å¯ä»¥é€é <code>depends_on</code> åƒæ•¸ä¾†å¼·åˆ¶æŒ‡å®šæ¨¡çµ„ä¹‹é–“çš„ä¾è³´é—œä¿‚ã€‚</li>
<li>ä½¿ç”¨ <code>depends_on</code> åƒæ•¸æ™‚ï¼Œéœ€ç‰¹åˆ¥æ³¨æ„ç›¸äº’ä¾è³´å¯èƒ½æœƒç”¢ç”Ÿçš„å¾ªç’°ä¾è³´å•é¡Œï¼ˆç”¢ç”Ÿé›ç”Ÿè›‹ã€è›‹ç”Ÿé›å•é¡Œï¼‰ã€‚</li>
</ul>
</li>
</ul>
<p><em>./main.tf</em><br>
å¯ä»¥ä½¿ç”¨ <code>depends_on</code> è®“ <code>depend-1</code> å…ˆå»ºç«‹ï¼Œå†å»ºç«‹ <code>depend-2</code>ï¼Œåœ¨éŠ·æ¯€çš„æ™‚å€™å‰‡æ˜¯å…ˆ <code>depend-2</code> å† <code>depend-1</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">module &quot;shannon-module-depend-1&quot; &#123;</span><br><span class="line">  source   = &quot;./modules/gcs&quot;</span><br><span class="line">  gcs_name = &quot;shannon-gcs-1&quot;</span><br><span class="line">  location = &quot;asia-east1&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module &quot;shannon-module-depend-2&quot; &#123;</span><br><span class="line">  source     = &quot;./modules/gcs&quot;</span><br><span class="line">  gcs_name   = &quot;shannon-gcs-2&quot;</span><br><span class="line">  location   = &quot;asia-east1&quot;</span><br><span class="line">  depends_on = [module.shannon-module-depend-1]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="3-Lifecycle-ç”Ÿå‘½é€±æœŸ">3. Lifecycle (ç”Ÿå‘½é€±æœŸ)</h2>
<ul>
<li><strong>ç”¨é€”</strong>
<ul>
<li>Terraform Lifecycle æŒ‡çš„æ˜¯æŒ‡ä»¤ç¢¼çš„åŸ·è¡Œé †åºå’ŒåŸ·è¡Œæ–¹å¼ï¼Œä¸»è¦åŒ…å«äº†ä»¥ä¸‹ä¸‰å€‹éšæ®µï¼š <code>create</code> ã€ <code>update</code> ã€ <code>destroy</code> ã€‚</li>
<li>ä½¿ç”¨è€…å¯ä»¥é€éæŒ‡å®šè‡ªå®šç¾©çš„åŸ·è¡Œé †åºä¾†æ§åˆ¶ Lifecycle çš„åŸ·è¡Œæ–¹å¼ï¼Œé€šå¸¸æ˜¯ç”¨ä¾†æ›´å¥½çš„æ§åˆ¶è³‡æºçš„å‰µå»ºèˆ‡æ›´æ–°ç­–ç•¥ã€‚</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong>
<ul>
<li>å¸¸è¦‹Lifecycleå±¬æ€§ï¼š<br>
<em>é¿å…è¢«åˆªé™¤ï¼š<code>prevent_destroy</code> â‡’ å¯ä»¥é¿å…ç™¼ç”Ÿåˆªé™¤</em><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;google_storage_bucket&quot; &quot;shannon-lifecycle-gcs&quot; &#123;</span><br><span class="line">  name          = &quot;shannon-lifecycle-test&quot;</span><br><span class="line">  location      = var.location</span><br><span class="line">  force_destroy = true</span><br><span class="line"></span><br><span class="line">  labels = &#123;</span><br><span class="line">    lifecycle : &quot;original2&quot;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  # lifecycle å¦‚æœæŠŠlabelsæ·»åŠ åœ¨ignore_changeçš„è©±labelså„˜ç®¡æœ‰æ›´æ–°æœ‰ä¸æœƒç™¼ç”Ÿæ›´æ–°</span><br><span class="line">  lifecycle &#123;</span><br><span class="line">    prevent_destroy = true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<em>å¿½ç•¥æ”¹è®Šï¼šignore_changes â‡’ ä¾‹å¦‚ç•¶labelæœ‰æ›´æ–°æ™‚ï¼Œæˆ‘å€‘å¯ä»¥å¿½ç•¥æ›´æ–°</em><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">resource &quot;google_storage_bucket&quot; &quot;shannon-lifecycle-gcs&quot; &#123;</span><br><span class="line">  name          = &quot;shannon-lifecycle-test&quot;</span><br><span class="line">  location      = var.location</span><br><span class="line">  force_destroy = true</span><br><span class="line"></span><br><span class="line">  labels = &#123;</span><br><span class="line">    lifecycle : &quot;original2&quot;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  # lifecycle å¦‚æœæŠŠlabelsæ·»åŠ åœ¨ignore_changeçš„è©±labelså„˜ç®¡æœ‰æ›´æ–°æœ‰ä¸æœƒç™¼ç”Ÿæ›´æ–°</span><br><span class="line">  lifecycle &#123;</span><br><span class="line">    ignore_changes = [ labels ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="4-Workspaces-å·¥ä½œå€">4. Workspaces (å·¥ä½œå€)</h2>
<ul>
<li><strong>æ¦‚å¿µ</strong>
<ul>
<li>å¯è¦–ç‚ºå°‡ä¸åŒç’°å¢ƒçš„ç›¸é—œè¨­å®šé›†åˆåœ¨ä¸€èµ·çš„å®¹å™¨ï¼Œä¾‹å¦‚é–‹ç™¼ã€æ¸¬è©¦ã€ç”Ÿç”¢ç­‰ã€‚</li>
<li>Terraform å¯ä»¥é€é workspace åˆ‡æ›ä¸åŒçš„ç’°å¢ƒï¼Œè®“<em>ä½¿ç”¨è€…åœ¨åŒä¸€å€‹ Terraform è¨­å®šæª”ä¸­ç®¡ç†å¤šå€‹ç’°å¢ƒ</em>ã€‚</li>
</ul>
</li>
<li><strong>æ³¨æ„äº‹é …</strong>
<ul>
<li>ä¸åŒ Workspace ä¹‹é–“çš„<em>è³‡æºæ˜¯ç¨ç«‹çš„ï¼Œä¸æœƒäº’ç›¸å¹²æ“¾</em>ã€‚</li>
<li>åœ¨ä¸åŒ Workspace ä¸­ä½¿ç”¨ç›¸åŒçš„è®Šæ•¸æ™‚ï¼Œéœ€è¦åœ¨æ¯å€‹ Workspace ä¸­å–®ç¨è¨­ç½®ã€‚</li>
</ul>
</li>
<li><strong>æœ€ä½³å¯¦è¸</strong>
<ul>
<li>æˆ‘å€‘æ“”å¿ƒä½¿ç”¨ç›¸åŒçš„éƒ¨ç½²æª”åœ¨ä¸åŒçš„workspaceå¾ˆæœ‰å¯èƒ½æœƒå› ç‚ºåœ¨åˆ¥çš„è³‡æºç”¢ç”Ÿç›¸åŒåç¨±çš„è³‡æºï¼Œå°è‡´åˆ‡æ›æˆåˆ¥çš„workspaceæ™‚ç”¢ç”Ÿè³‡æºç™¼ç”Ÿè¡çª</li>
<li>æˆ‘å€‘å¯ä»¥é€é<code>$&#123;terraform.workspace&#125;</code>ä¾†æ ¹æ“šç•¶å‰çš„spaceä¾†ä½¿ç”¨</li>
<li>ä½†æ˜¯æœ€ä½³å¯¦è¸é‚„æ˜¯æ¯å€‹å°ˆæ¡ˆéƒ½æœ‰è‡ªå·±çš„è¨­å®šæª”æ¯”è¼ƒå¥½</li>
</ul>
</li>
<li><strong>ç¯„ä¾‹</strong></li>
</ul>
<p><em>Demo</em> æ­¥é©Ÿ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‰µå»ºdev/prdå…©å€‹å·¥ä½œç©ºé–“workspace</span></span><br><span class="line">terraform workspace new dev</span><br><span class="line">terraform workspace new prd</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœ‰å“ªäº›workspace</span></span><br><span class="line">terraform workspace list</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¸æ“‡workspace dev å·¥ä½œç©ºé–“åšåˆå§‹åŒ–ï¼Œè§€å¯Ÿterraform.tfstate.dè³‡æ–™å¤¾</span></span><br><span class="line">terraform workspace <span class="keyword">select</span> dev</span><br><span class="line">terraform init</span><br><span class="line">terraform plan</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›åˆ°prdçš„å·¥ä½œç©ºé–“workspaceåšåˆå§‹åŒ–ï¼Œè§€å¯Ÿterraform.tfstate.dè³‡æ–™å¤¾</span></span><br><span class="line">terraform workspace <span class="keyword">select</span> prd</span><br><span class="line">terraform init</span><br><span class="line">terraform plan</span><br><span class="line"></span><br><span class="line"><span class="comment"># åšéƒ¨ç½²</span></span><br><span class="line">terraform apply -auto-approve</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¸…ç†dev/prdçš„è³‡æº</span></span><br><span class="line">terraform workspace <span class="keyword">select</span> dev</span><br><span class="line">terraform destroy -auto-approve</span><br><span class="line"></span><br><span class="line">terraform workspace <span class="keyword">select</span> prd</span><br><span class="line">terraform destroy -auto-approve</span><br></pre></td></tr></table></figure>
<h1 id="æœ€ä½³å¯¦è¸åƒè€ƒ">æœ€ä½³å¯¦è¸åƒè€ƒ</h1>
<ol>
<li>å¯ä»¥éµå¾ª <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.terraform-best-practices.com/zh">Terraform æœ€ä½³å¯¦è¸</a>ä¾†å»ºç«‹å°ˆæ¡ˆï¼Œæˆ–æ˜¯åƒè€ƒ<a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/qwedsazxc78/terraform-project-best-practice.git">qwedsazxc78/terraform-project-best-practice</a>ã€‚</li>
<li>åŸºç¤æ¶æ§‹æœ‰å¾ˆå¼·çš„ä¾è³´æ€§ï¼Œæœ€å¥½ä½¿ç”¨æ•¸å­—æ¨™è™Ÿï¼Œå‘ŠçŸ¥ä»–å€‘å»ºç«‹çš„é †åº</li>
</ol>
<h1 id="ç¸½çµ">ç¸½çµ</h1>
<p>åœ¨äº†è§£å…ƒä»¶ä¹‹å¾Œï¼Œå…ƒä»¶èˆ‡å…ƒä»¶ä¹‹é–“çš„é—œä¿‚æˆ‘è¦ºå¾—å¯ä»¥é¤é€™ä»¥ä¸‹é€™å€‹åœ–ç‰‡é€™æ¨£èªªæ˜ï¼š<br>
<img src="/img/loading-icon.gif" data-original="/img/figure/tf-sum-up.png" alt=""></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="https://shannonhung.github.io">Shannon Hung</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>æ–‡ç« é€£çµ: </span><span class="post-copyright-info"><a href="https://shannonhung.github.io/posts/terraform-guide/">https://shannonhung.github.io/posts/terraform-guide/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>ç‰ˆæ¬Šè²æ˜: </span><span class="post-copyright-info">æœ¬éƒ¨è½æ ¼æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥è²æ˜å¤–ï¼Œå‡æ¡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è¨±å¯å”è­°ã€‚è½‰è¼‰è«‹è¨»æ˜ä¾†è‡ª <a href="https://shannonhung.github.io" target="_blank">Shannon's Blog ğŸŸ æŠ€è¡“ | ç”Ÿæ´» | æ—…è¡Œ</a>ï¼ <em>å¦‚æœä½ è¦ºå¾—æˆ‘çš„æ–‡ç« æœ‰å¹«åŠ©ï¼Œå¸Œæœ›ä½ å¯ä»¥åˆ°æˆ‘çš„ github çµ¦æˆ‘ä¸€å€‹ star â­ï¸ <a href="https://github.com/ShannonHung/ShannonHung.github.io" rel="external nofollow noreferrer" target="_blank">Shannon Blog Repo</a></em></span></div></div><div class="post_share"><div class="social-share" data-image="/img/cover/terraform.png" data-sites="facebook"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/leetcode-200-number-of-islands/" title="LeetCode #200 Number of Islands - åˆ·é¡Œä¹‹æ—…"><img class="cover" src="/img/loading-icon.gif" data-original="/img/cover/kung-fu.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">LeetCode #200 Number of Islands - åˆ·é¡Œä¹‹æ—…</div></div></a></div><div class="next-post pull-right"><a href="/posts/terraform-gke-guide/" title="ä½¿ç”¨ Terraform å»ºç«‹ GKE å¢é›† - å¾ç„¡åˆ°æœ‰å»ºç«‹ Google Kubernetes Engine å¢é›† + Nginx Load Balancer + æ¸¬è©¦"><img class="cover" src="/img/loading-icon.gif" data-original="/img/cover/night-city.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ä½¿ç”¨ Terraform å»ºç«‹ GKE å¢é›† - å¾ç„¡åˆ°æœ‰å»ºç«‹ Google Kubernetes Engine å¢é›† + Nginx Load Balancer + æ¸¬è©¦</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸é—œæ¨è–¦</span></div><div class="relatedPosts-list"><div><a href="/posts/terraform-gke-guide/" title="ä½¿ç”¨ Terraform å»ºç«‹ GKE å¢é›† - å¾ç„¡åˆ°æœ‰å»ºç«‹ Google Kubernetes Engine å¢é›† + Nginx Load Balancer + æ¸¬è©¦"><img class="cover" src="/img/loading-icon.gif" data-original="/img/cover/night-city.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-28</div><div class="title">ä½¿ç”¨ Terraform å»ºç«‹ GKE å¢é›† - å¾ç„¡åˆ°æœ‰å»ºç«‹ Google Kubernetes Engine å¢é›† + Nginx Load Balancer + æ¸¬è©¦</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è©•è«–</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/loading-icon.gif" data-original="/img/dudu-me.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Shannon Hung</div><div class="author-info__description">çˆ²äº†é¿å…å¥å¿˜ï¼Œè€Œé–‹å§‹è¨˜éŒ„</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">122</div></a><a href="/tags/"><div class="headline">æ¨™ç±¤</div><div class="length-num">76</div></a><a href="/categories/"><div class="headline">åˆ†é¡</div><div class="length-num">40</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/ShannonHung"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ShannonHung" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:hsuanhung036@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #24292e;"></i></a><a class="social-icon" href="https://www.linkedin.com/in/hung-yi-hsuan/" rel="external nofollow noreferrer" target="_blank" title="LinkedIn"><i class="fab fa-linkedin" style="color: #0077b5;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">å—¨ï½æˆ‘æ˜¯Shannonï¼Œé–‹å§‹æ¶è¨­æ­¤ç¶²ç«™çš„åŸå› æ˜¯ï¼Œå› ç‚ºè‡ªå·±çš„è¨˜æ†¶åŠ›å¤ªéæ–¼çŸ­æš«ï¼Œé›–ç„¶å­¸äº†å¾ˆå¤šï¼Œä½†ä¹Ÿå¿˜è¨˜å¾ˆå¤šã€‚ç‚ºäº†é¿å…å¥å¿˜ï¼Œé–‹å§‹æˆ‘çš„ç­†è¨˜ç”Ÿæ´»ã€‚</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®éŒ„</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BB%8B%E7%B4%B9"><span class="toc-text">ä»‹ç´¹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#IaC-%E5%B7%A5%E5%85%B7%E5%B7%AE%E7%95%B0"><span class="toc-text">IaC å·¥å…·å·®ç•°</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Terraform-%E6%B5%81%E7%A8%8B"><span class="toc-text">Terraform æµç¨‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%85%83%E4%BB%B6"><span class="toc-text">æ ¸å¿ƒå…ƒä»¶</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A4%8E%E7%AF%87"><span class="toc-text">åŸºç¤ç¯‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Providers-%E4%BE%9B%E6%87%89%E5%95%86"><span class="toc-text">1. Providers (ä¾›æ‡‰å•†)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Resource-%E8%B3%87%E6%BA%90"><span class="toc-text">2. Resource (è³‡æº)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Provisioners-%E9%85%8D%E7%BD%AE%E5%99%A8"><span class="toc-text">3. Provisioners (é…ç½®å™¨)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Variables-%E8%AE%8A%E6%95%B8"><span class="toc-text">4. Variables (è®Šæ•¸)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%8A%E6%95%B8%E5%9E%8B%E6%85%8B"><span class="toc-text">è®Šæ•¸å‹æ…‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%8A%E6%95%B8%E7%B9%BC%E6%89%BF%E9%A0%86%E5%BA%8F"><span class="toc-text">è®Šæ•¸ç¹¼æ‰¿é †åº</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Data-Source-%E8%B3%87%E6%96%99%E4%BE%86%E6%BA%90"><span class="toc-text">5. Data Source (è³‡æ–™ä¾†æº)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Outputs-%E8%BC%B8%E5%87%BA"><span class="toc-text">6. Outputs (è¼¸å‡º)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-State-%E7%8B%80%E6%85%8B"><span class="toc-text">7. State (ç‹€æ…‹)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-Backend-%E9%81%A0%E7%AB%AF%E7%8B%80%E6%85%8B%E5%BE%8C%E5%8F%B0"><span class="toc-text">8. Backend (é ç«¯ç‹€æ…‹å¾Œå°)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%B2%E9%9A%8E%E7%AF%87"><span class="toc-text">é€²éšç¯‡</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-Modules-%E6%A8%A1%E7%B5%84"><span class="toc-text">1. Modules (æ¨¡çµ„)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Dependency-%E4%BE%9D%E8%B3%B4"><span class="toc-text">2. Dependency (ä¾è³´)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Lifecycle-%E7%94%9F%E5%91%BD%E9%80%B1%E6%9C%9F"><span class="toc-text">3. Lifecycle (ç”Ÿå‘½é€±æœŸ)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Workspaces-%E5%B7%A5%E4%BD%9C%E5%8D%80"><span class="toc-text">4. Workspaces (å·¥ä½œå€)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90%E5%8F%83%E8%80%83"><span class="toc-text">æœ€ä½³å¯¦è¸åƒè€ƒ</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B8%BD%E7%B5%90"><span class="toc-text">ç¸½çµ</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By Shannon Hung</div><div class="footer_custom_text">Hi, welcome to Shannon <a target="_blank" rel="noopener external nofollow noreferrer" href="https://butterfly.js.org/">blog</a>!</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é–±è®€æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="å–®æ¬„å’Œé›™æ¬„åˆ‡æ›"><i class="fas fa-arrows-alt-h"></i></button><a id="to_comment" href="#post-comment" title="ç›´é”è©•è«–"><i class="fas fa-comments"></i></a></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="è¨­å®š"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®éŒ„"><i class="fas fa-list-ul"></i></button><button id="translateLink" type="button" title="ç°¡ç¹è½‰æ›">ç¹</button><button id="darkmode" type="button" title="æ·ºè‰²å’Œæ·±è‰²æ¨¡å¼è½‰æ›"><i class="fas fa-adjust"></i></button><button id="go-up" type="button" title="è¿”å›é ‚éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>(() => {
  const initGitalk = () => {
    const gitalk = new Gitalk(Object.assign({
      clientID: '51917ecdc184bb98b226',
      clientSecret: 'e48b44c1908c14b74ff7513f06c7cb892a4f4748',
      repo: 'shannonhung.github.io',
      owner: 'ShannonHung',
      admin: ['ShannonHung'],
      id: '2017f24253d9c2e5179045d5f1bbcfb8',
      updateCountCallback: commentCount
    },null))

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async() => {
    if (typeof Gitalk === 'function') initGitalk()
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css')
      await getScript('https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.js')
      initGitalk()
    }
  }
  
  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script data-pjax src="/self/btf.js"></script><script data-pjax src="/self/tw_en.js"></script><script data-pjax src="/self/calendar.js"></script><script data-pjax src="/self/languages.js"></script><script id="canvas_nest" defer="defer" color="139,71,38" opacity="0.5" zIndex="-1" count="500" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœå°‹</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  è³‡æ–™åº«è¼‰å…¥ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœå°‹æ–‡ç« " type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 3,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(r){r.imageLazyLoadSetting.processImages=t;var e=r.imageLazyLoadSetting.isSPA,n=r.imageLazyLoadSetting.preloadRatio||1,c=a();function a(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(c=a());for(var t,o=0;o<c.length;o++)0<=(t=(t=c[o]).getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(r.innerHeight*n||document.documentElement.clientHeight*n)&&function(){var t,e,n,a,i=c[o];e=function(){c=c.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(n=new Image,a=t.getAttribute("data-original"),n.onload=function(){t.src=a,t.removeAttribute("data-original"),e&&e()},t.src!==a&&(n.src=a))}()}function i(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",i),r.addEventListener("resize",i),r.addEventListener("orientationchange",i)}(this);</script></body></html>